var $str, $ElemId, $dataId, $dataField, $dataAction, $dataType, $comboNum, $imgType;
var $qLoadFlag = 1;
var $url = document.location.href;
var $fileLink = "";
var $window = $('#admwindow');
jQuery.fn.extend({
	admSplitId: function() {/* split element id and take data from it */
		$ElemId = $(this).attr("id");
		$dataArr = $ElemId.split("-");
		if($dataArr[0] == "admedt") {/* if "fast edit" element */
            $qLoadFlag = 1;
			$dataId = Number($dataArr[1]);
			$dataType = $dataArr[2];			
		} else if ($dataArr[0] == "upfield" || $dataArr[0] == "admimg") {/* if file upload fields */
			if ($dataArr[1]) $dataId = Number($dataArr[1]);
			else $dataId = $windowId;
			if ($dataArr[2]) {
				if ($dataArr[2]!="winsingle" && $dataArr[2]!="winmulti" && $dataArr[2]!="pagemulti") {$imgType = "-"+$dataArr[2]; $dataType = "";}
				else {$dataType = "-"+$dataArr[2];$imgType = "";}
			} else $dataType = "";
			if ($dataArr[3]) $imgType = "-"+$dataArr[3];
		} else if ($dataArr[0] == "admbtn") {/* if one of "fast edit" buttons */
            $dataAction = $dataArr[1];
			$dataType = $dataArr[2];
		} else if ($dataArr[0] == "admfile") {/* if one of "fast edit" buttons */
            $dataAction = $dataArr[1];
		} else if ($dataArr[0] == "admpnl") {/* if one of "admin panel" buttons */
            $qLoadFlag = 0;
			$dataAction = $dataArr[1];
			$dataType = $dataArr[2];
		} else if ($dataArr[0] == "admwin") {/* if one of "admin window" buttons */
            $dataType = $dataArr[1];
			$dataField = $dataArr[2];
		} else if ($dataArr[0] == "admcon") {/* if one of "admin wraped" elements */
			$dataId = Number($dataArr[1]);
		} else if ($dataArr[0] == "admico") {/* if one of "admin wraped" elements */
			$dataAction = $dataArr[1];// action
			$dataId = Number($dataArr[2]);// stuff (that contains image) id
			$dataKey = Number($dataArr[3]);// image (from stuff) id
			if ($dataKey<10) $dataKey = '0'+$dataKey;
			if ($dataAction == "additionalFileRemove"){
				if ($dataArr[4]) $winFlag = true;
				else $winFlag = false;
			}	
		}
		return this;
	},
	winData: function(){ /* take data for sending from admin window selected by types */
		$dataValue = {};
		$totalBox = $("#adm-total");
		if ($(document).is(":has(*[id^=adm-total-])")) $multiBoxes = true;
		else $multiBoxes = false;
		$(this).each(function(i){
			$(this).admSplitId();
			if($dataType == 'text') { /* if text */
				id = $(this).find("textarea[id^='editarea']").attr('id');
				$dataValue[$dataField] = CKEDITOR.instances[id].getData();
            } else if($dataType == 'textline') { /* if text */
				$dataValue[$dataField] = $(this).find("input:text").val();
			} else if($dataType == 'radio') { /* if radio */
				$dataValue[$dataField] = $(this).find("input:radio:checked").val();
			} else if ($dataType == 'date') { /* if date */
				$dateArray = $datePick.val().split(".");
				$dataValue[$dataType] = $dateArray[2]+"-"+$dateArray[1]+"-"+$dateArray[0];	
			} else if ($dataType == 'check') { /* if checkbox */
				if($("#"+$ElemId).children("input:checkbox").is(":checked")) $dataValue[$dataField] = 1;
				else $dataValue[$dataField] = 0;				
			} else if ($dataType == 'select') { /* if selector */
                $dataValue[$dataField] = $(this).find("select option:selected").val();
				$comboNum = $dataValue[$dataField];
				if ($comboNum && $multiBoxes) $totalBox = $("#adm-total-"+$comboNum);
            } else if ($dataType == 'winfile') { /* if file */
				$dataValue[$dataField] = 1;
			}
			$str = $.toJSON($dataValue); /* data array collected from fields */
		});
		return this;
	}
});
//	file upload
jQuery.fn.extend({
	upload: function(){
		if ($(document).is(":has(input[id^=upfield])")) $("input[id^=upfield]").remove();
		$response = "";
		$statusbar = $(".b-admin-status-bar");		
		$(this).each(function(){
			button = $(this);
			button.admSplitId();
			new AjaxUpload(this, {
				action: '',
				name: 'upload',
				data: {},
				id: $dataId,
				type: $dataType,
				imgType: $imgType,
				onSubmit: function(file, ext){					
					this.disable();
					$statusbar.status('Загрузка файла.', false);
					$("input[id^=upfield]:visible").winData();
					if (!$imgType) $imgType = "";
					$("#admimg-"+$dataId+$dataType+$imgType).before('<div class="uploading"><i></i></div>');
					if ($dataType=="-winmulti" || $dataType=="-pagemulti") $ajaxName = 'additionalFileAdd';
					else $ajaxName = 'file';
					if ($dataType=="-winmulti" || $dataType=="-winsingle") $qLoadFlag = 0;
					else $qLoadFlag = 1;
					this.setData({'ajax':$ajaxName, 'qload':$qLoadFlag, 'id':$dataId, 'imgType':$imgType});
					if (!(ext && /^(jpg|png|jpeg|gif|zip)$/.test(ext))){
						$("div.uploading").remove();
						$statusbar.addClass("error").html('<span class="status-hd">Status:</span> Error: Invalid file type. Allowed file types: .jpg, .png, .jpeg, .gif.').slideDown(200);
						setTimeout('$statusbar.slideUp(150).removeClass("error");', 8000);
						this.enable();
						return false;
					} else $statusbar.html("Status: Saving new file.").slideDown(150);
				},
				onComplete: function(file, response){
					try{
						if ($.secureEvalJSON(response).status == "success") {
							$statusbar.status('Files upload completed.', false);
							$respLink = $.secureEvalJSON(response).link;
							$respSize = $.secureEvalJSON(response).size;
							var reg=/.+?(\d+).+?(\d+)/;
							var arr=reg.exec($respSize);
							if (arr) {$width = Number(arr[1]);$height = Number(arr[2]);}
							$response = $respLink;
							if ($dataType=="-winmulti"||$dataType=="-pagemulti") $("#admico-additionalFileShow-"+$dataId).clkCheck();
							else {
								$fileLink = $respLink;
								$random = Math.floor(Math.random()*10001);
								$("#admimg-"+$dataId+$dataType+$imgType).attr({"src":$response+"?"+$random}).attr({"width":$width, "height":$height})
							}	
							$("div.uploading").remove();
							$statusbar.removeClass("error").html('<span class="status-hd">Status:</span> File saved.');
							setTimeout('$statusbar.slideUp(150);', 1200);
						} else {
							$statusbar.status('Error:'+$.secureEvalJSON(response).reason+'.', true);
						}
						this.enable();
					} catch(e) {
						$statusbar.status('Error:'+e.message+', reason:'+response+'.', true);
					} finally {												
						$statusbar.slideUp(150);
					}
				}
			});			
		});
	}
});
// check and uncheck
jQuery.fn.extend({
	check: function() {return this.each(function() {this.checked = true;});},
	uncheck: function() {return this.each(function() {this.checked = false;});},
	togglecheck: function(){return this.each(function() {
		if (!this.checked) this.checked = true;
		else this.checked = false;
		});
	},
	disable: function() {return this.attr("disabled","disabled");},
	enable: function() {return this.removeAttr("disabled");}
});
var $statusError = false;
var $statusbar = $("#admStatBar");
var $statushead = '<span class="status-hd">Status: </span>';
jQuery.fn.extend({
	status: function($statustext, $statusError){
		if ($statusError) {$statusbar.addClass("error");$statustimer = 6000;}
		else {$statusbar.removeClass("error");$statustimer = 2000;}
		$statusbar.html($statushead+$statustext).slideDown(150).statusHide();
	},
	statusHide: function(){
		setTimeout('$statusbar.slideUp(150);', $statustimer);
	}
});
var $checkedArr = new Array();
jQuery.fn.extend({
	admCheck: function(){
		if ($("*[id^='admcon-']")) {
			$adminFlag = true;
			if ($(".b-adm-container").is(".b-single")) $singleFlag = true;
			else $singleFlag = false;
		} else $adminFlag = false;
		if ($adminFlag) {
			$.fn.fancybox.build();
			$("a.fancy").fancybox();
			$("#admwindow").show().dialog({width:550, height:500}).dialog("close");
			$("*[id^='admedt-']").bind("mouseenter", function(){$(this).addClass("adm-hover");}).bind("mouseleave", function(){$(this).removeClass("adm-hover");});
			$("*[id^='admcon-']").arrCheck();
			$panelFlag = false;
			$statusbar = $("#admStatBar");
			$panelBar = $("#admActBar");
			$("*[id^='admimg-']").addClass("upload").upload();
			if (!$(document).is(":has(*[id^='adm-total'])")) $("#admpnl-add").disable();
			else {
				$("#admpnl-add").enable();
				$checkboxes = $("input:checkbox[id^='admchk-']");
				$checksOn = $("input:checkbox[id^='admchk-']:checked").size();
				$checksAll = $checkboxes.size();
			}
			$("#admActBar input:button").each(function(){
				if ($(this).is(':enabled')) $panelFlag = true;
			});
			if ($panelFlag) $panelBar.show();
			else $panelBar.hide();
			$("#admpnlplace").height("auto");
			$admH = $("#admbar").height();
			$("#admpnlplace").css({"height":($admH/16)+"em"});			
		}
		return this;
	},
	arrCheck: function() {
		if (!$singleFlag) {
			$checkboxes = $("input:checkbox[id^='admchk-']");
			$checksOn = $("input:checkbox[id^='admchk-']:checked").size();
			$checkboxes.parent().parent().removeClass("box-checked");
			$("input:checkbox[id^='admchk-']:checked").parent().parent().addClass("box-checked");
			$checksAll = $checkboxes.size();
			if (!$checksAll) $("#admpnl-sel").disable();
			if (!$checksOn) $("#admpnl-del, #admpnl-act, #admpnl-edt").disable();
			else if ($checksOn == 1) $("#admpnl-del, #admpnl-act, #admpnl-edt").enable();				
			else if ($checksOn > 1) {
				$("#admpnl-del, #admpnl-act").enable();
				$("#admpnl-edt").disable();
			}
			$checkedArr = new Array();
			$(this).each(function(i){
				if ($(this).is(":checked")) {
					$id = $(this).attr("id").split("-");
					$checkedArr[$checkedArr.length] = Number($id[1]);
				}
			});
		} else {
			$singleObj = $("*[id^='admcon']");
			$singleId = $singleObj.attr("id");
			$id = $singleId.split("-");
			$checkedArr[$checkedArr.length] = Number($id[1]);
			$("#admpnl-del, #admpnl-act, #admpnl-edt").enable();
			$("#admpnl-sel").disable();
		}
		if ($("input:checkbox[id^='admchk-']:checked").attr("rel")=="noedt") $("#admpnl-edt").disable();
		if ($("input:checkbox[id^='admchk-']:checked").attr("rel")=="nodel") $("#admpnl-del").disable();
		if ($("input:checkbox[id^='admchk-']:checked").attr("rel")=="noact") $("#admpnl-act").disable();
		if ($("input:checkbox[id^='admchk-']:checked").attr("rel")=="nonew") $("#admpnl-add").disable();
		return this;
	},
	btnCheck: function(){
		$(this).admSplitId();
		if ($dataAction == "add") {// admin panel "add"
			$statusbar.status('Receiving data for adding.', false);
            $windowId = 0;
			$.post($url,{'ajax':'loadWindowAdd'},
				function(json, textStatus){
					if (json.status == 'success') {
						$window = $('#admwindow');
						$window.html(json.html);
						$window.find("input:checkbox.check-active").check();
						$window.dialog("open").dialog('option', 'title', 'Adding');
						$("a.ui-dialog-titlebar-close").click(function(){$('#admwindow input.datepickfield').DatePickerHide();});
						$window.initEditor();
						if ($window.is(":has(img[id^='admimg'])")) $imgFlag = true;
						else $imgFlag = false;
						if ($imgFlag) {
							$("img[id^='admimg']").upload();
							$preH = $window.find("img[id^='admimg']").height();
							$preW = $window.find("img[id^='admimg']").width();
							$("img[id^='admimg']").parent().css({"height":$preH+"px", "width":$preW+"px"});
						}
						$("input[id^='pickdate']").initDate();												
						$statusbar.status('Data recieved.', false);
					} else $statusbar.status('Error, server response: «'+json.reason+'».', true);
				}, "json"
			);
		} else if ($dataAction == "saveAdd") {// admin panel "save add"
			$statusbar.status('Saving new data.', false);
			$clicked.disable();
            $qLoadFlag = 0;
			$("div[id^='admwin-']").winData();
			$.post($url,{'ajax':'add', 'json':$str, 'file':$fileLink, 'imgType':$imgType},
				function(json, textStatus){
					if (json.status == 'success') {
                        $window.dialog("close");
						$statusbar.status('New data saved.', false);
						if (!$singleFlag) {
							$qLoadFlag = 1;
							$totalBox.prepend(json.html);
                            $totalBox.find("*[id^='admcon-']:first").addClass("fresh");
							$(".fresh").find("*[id^='admimg-']").upload();
							$checkboxes.arrCheck();							
                        }
					} else $statusbar.status('Error, server response: «'+json.reason+'».', true);
				}, "json"
			);
			
		} else if ($dataAction == "edt") {// admin panel "edit"
			$statusbar.status('Data recieving.', false);
			if (!$singleFlag) $ThisId = $("input:checkbox:checked[id^='admchk-']").parent().parent().attr('id').split('-');
			else $ThisId = $singleId.split('-');
			$ThisIdNum = Number($ThisId[1]);
			$windowId = $ThisIdNum;
			$.post($url,{'ajax':'loadWindowEdit', 'id':$ThisIdNum},
				function(json, textStatus){
					if (json.status == 'success') {
						$window = $('#admwindow');
                        $window.html(json.html).dialog("open").dialog('option', 'title', 'Editing');
						$window.initEditor();
						$window.find("input[id^='pickdate']").initDate();
						$("a.ui-dialog-titlebar-close").click(function(){$("input[id^='pickdate']").DatePickerHide();});
						if ($window.is(":has(img[id^='admimg'])")) $imgFlag = true;
						else $imgFlag = false;
						if ($imgFlag) {
							$("img[id^='admimg']").upload();
							$preH = $window.find("img[id^='admimg']").height();
							$preW = $window.find("img[id^='admimg']").width();
							$window.find("img[id^='admimg']").parent().css({"height":$preH+"px", "width":$preW+"px"});
						}
						$statusbar.status('Data recieved.', false);
					} else $statusbar.status('Error, server response: «'+json.reason+'».', true);
				}, "json"
			);
		} else if ($dataAction == "saveEdit") {// admin panel "save edit"
			$statusbar.status('Saving edited data.', false);
			$clicked.disable();
            $qLoadFlag = 0;
            $("div[id^='admwin-']").winData();
			$.post($url,{'ajax':'edit', 'json':$str, 'id':$ThisIdNum, 'file':$fileLink, 'imgType':$imgType},
				function(json, textStatus){
					if (json.status == 'success') {
						$("#admwindow").dialog("close");
						$qLoadFlag = 1;
						if (!$singleFlag) {
							$box = $("input:checkbox[id^='admchk']:checked").parent().parent();
							if ($multiBoxes){
								$totalBox.prepend(json.html);
								$box.remove();
							} else $box.replaceWith(json.html);
							$box.find(".upload").upload();
							$checkboxes.uncheck().arrCheck();
						} else $singleObj.replaceWith(json.html);
						$imgsrc = $("#admimg-"+$ThisIdNum+$imgType).attr("src");
						$random = Math.floor(Math.random()*100001);
						$("#admimg-"+$ThisIdNum+$imgType).attr("src", $imgsrc+"?"+$random);
						$statusbar.status('Data saved.', false);
					} else $statusbar.status('Error, server response: «'+json.reason+'».', true);
				}, "json"
			);
		} else if ($dataAction == "del") {// admin panel "delete"
            $askDel = "Data will be deleted. There is no undo. Proceed?";
			if (!$singleFlag) $checkboxes.arrCheck();
			$str = $.toJSON($checkedArr);
			if (confirm($askDel)) {
				$statusbar.status('Deletion confirmed.', false);
				$clicked.disable();
				$clicked.siblings("input:button").disable();
				$statusbar.removeClass("error").html('<span class="status-hd">Status:</span> Data deletion confirmed.').slideDown(150);
				if (!$singleFlag) $checkboxes.arrCheck();
				$str = $.toJSON($checkedArr);
				$.post($url,{'ajax':'remove', 'json':$str},
					function(json, textStatus){
						if (json.status == 'success') {
							if (!$singleFlag) {
								$box = $("input:checkbox:checked[id^='admchk-']").uncheck().parent().parent();
								$box.slideUp(150);
								$checkboxes.arrCheck();
							} else $singleObj.slideUp(150);
							$statusbar.status('Data succsesfully deleted.', false);
						} else $statusbar.status('Error, server response: «'+json.reason+'».', true);
					}, "json"
				);
			} else {
				$statusbar.status('Data deletion canceled.', false);
				$clicked.disable();
				$clicked.siblings("input:button").disable();
				$('#admwindow').dialog("close");
				$checkboxes.uncheck().arrCheck();
				setTimeout('$statusbar.slideUp(150);', 1200);
			}
        } else if ($dataAction == "act") {// admin panel "activity"
			$statusbar.status('Selected elements activity changing.', false);
            if (!$singleFlag) $checkboxes.arrCheck();
			$str = $.toJSON($checkedArr);
			$.post($url,{'ajax':'activity', 'json':$str}, function(json, textStatus){
					if (json.status == 'success') {
						if (!$singleFlag) {
							$box = $("input:checkbox[id^='admchk-']:checked").parent().parent();
							$box.toggleClass("b-active0");
							$("input:checkbox[id^='admchk-']:checked").uncheck();
							if (!$singleFlag) $checkboxes.arrCheck();
							$("#admpnl-sel").val("Выбрать все");
						} else $singleObj.toggleClass("b-active0");
						$statusbar.status('Activity changed.', false);						
					} else $statusbar.status('Error, server response: «'+json.reason+'».', true);
				}, "json"
			);
		} else if ($dataAction == "sel") {// admin panel "select" checkboxes
			$checkboxes.arrCheck();
			if ($checksOn != $checksAll) {
				$checkboxes.check().arrCheck();
				$(this).val("Uncheck all");
			} else {
				$checkboxes.uncheck().arrCheck();
				$(this).val("Check all");
			}
		}
		$fileLink = "";
		return this;
	},
	initDate: function(){
		$datePick = $(this);
		$datePick.DatePicker({
			format:'d.m.Y',
			date:$datePick.val(),
			current:$datePick.val(),
			starts:1,
			position:'top',
			onBeforeShow: function(){
				$datePick.DatePickerSetDate($datePick.val(), true);
			},
			onChange: function(formated, dates){
				$datePick.val(formated);
			}
		});
	},
	admHandle: function(){
		$(document).click (function(e){
			$clicked=$(e.target);
			e.stopPropagation();
			$clicked.clkCheck();
		});
	},
	clkCheck: function(){// click checker
		$clicked = $(this);
		if (!$clicked.is(":disabled")) {// if $clicked disabled do nothing	
			$checking = $clicked.parent();// check if clicked parent is editable
			for (k=1;k<=5;k++) {// checking 4 parents tree
				if ($checking.is("*[id^='admedt-']") && !$clicked.is("*[id^='adm']") && !$clicked.is(".cmsfield") && !$clicked.is("*[id^='cke_']") && !$clicked.is("input, textarea")) $clicked = $checking;
				else $checking = $checking.parent();
			}
			if ($clicked.is("*[id^='admedt-']") && !$clicked.is(".editable") && !$clicked.is("*[id^='cke_']") && !$clicked.children().is("*[id^='cke_']")) $clicked.actEditLoad();// if admin edit & editable call load action
			else if ($clicked.is("input:button[id^='admbtn-']")) $clicked.actEditSave();
			else if ($clicked.is("input:checkbox[id^='admchk-']")) $checkboxes.arrCheck();
			else if ($clicked.is("*[id^='admimg-']")) $clicked.upload();
			else if ($clicked.is("input:button[id^='admpnl-']")) $clicked.btnCheck();
			else if ($clicked.is("*[id^='admico-']") && !$clicked.is(".disabled")) $clicked.actIcon();
			else if ($clicked.is("*[id^='admfile-']") && !$clicked.is(".disabled")) $clicked.upfile();
		}	
		return this;
	},
	actEditLoad: function(){// fast edit load action
		$statusbar.status('Quick edit form loading.', false);
		$clicked.prepend('<div class="uploading"><i></i></div>');
		$clicked.admSplitId();
		$dataAction = "load";
		$.post($url,{'ajax':$dataAction, 'type':$dataType, 'id':$dataId},function(json, textStatus){
			if (json.status == 'success') {
				$statusbar.status('Form loaded', false);
				$clicked.removeClass("hover, adm-hover").html(json.html);
				$("input[id^='pickdate']").initDate();
				$clicked.children("*[id^='admimg']").upload();
				$clicked.initEditor();
				$("div.uploading").remove();
			} else $statusbar.status('Error: '+json.reason+'.', true);
		}, "json");
	},
	actEditSave: function(){// fast edit save action
		$statusbar.status('Data transfer.', false);
		$clicked.admSplitId().disable().siblings("input:button").disable();
		$checked = $clicked.parent();
		$inputBox = 0;
		for (j=1;j<=5;j++) {
			if ($checked.is("*[id^='admedt-']")) $inputBox = $checked;
			else $checked = $checked.parent();
		}
		if ($dataType == "date") {// fast edit of date
			$dateArray = $datePick.val().split(".");
			$dataValue = $dateArray[2]+"-"+$dateArray[1]+"-"+$dateArray[0];
		} else if ($dataType == "text") {// fast edit of text 
			id = $inputBox.children("textarea").attr('id');
			$dataValue = CKEDITOR.instances[id].getData();
		} else if($dataType == 'textline') { /* if text */
			$dataValue = $inputBox.children("input:text").val();
		} else if ($dataType == "select") {// fast edit of select fields
			$dataValue = $inputBox.children("select").val();
		} else if ($dataType == "radio") {// fast edit of radio button
			$dataValue = $inputBox.children("input:radio:checked").val();
		} else $dataValue = ""; // if other, no type value
		$inputBox.admSplitId();
		$inputBox.prepend('<div class="uploading"><i></i></div>');
		$.post($url,{'ajax':$dataAction, 'type':$dataType, 'id':$dataId, 'value':$dataValue},
			function(json, textStatus){
				if (json.status == 'success') {
					$statusbar.status('Data saved.', false);
					$("div.uploading").remove();
					$inputBox.removeClass("adm-hover").html(json.html);
				} else $statusbar.status('Error: '+json.reason+'.', true);
			}, "json");
		$inputBox.removeClass("editable").removeClass("adm-hover");
	},
	actIcon: function(){
		$clicked.admSplitId();
		$clicked.addClass("disabled").prepend('<div class="uploading"><i></i></div>');
		if ($dataAction == "additionalFileHide") {
			$("#additionalFileBlock-"+$dataId+", #admico-additionalFileHide-"+$dataId).remove();
			$openBox.show();
		} else {
			if ($dataAction == "additionalFileRemove") {
				if ($winFlag) $("#addImg-"+$dataId+"-"+$dataKey+"-win").fadeOut(150);
				$("#addImg-"+$dataId+"-"+$dataKey).fadeOut(150);
			}
			$.post($url,{'ajax':$dataAction, 'id':$dataId, 'key':$dataKey, 'qload':$qLoadFlag},
			function(json, textStatus){
				if (json.status == 'success') {
					$("div.uploading").remove();
					if ($dataAction == "additionalFileShow") {						
						if ($qLoadFlag == 1) $("#addImgBox-"+$dataId).replaceWith(json.html);
						else {
							$openBox = $clicked;
							$clicked.hide();
							if ($(document).is(":has(#additionalFileBlock-"+$dataId+")")) $("#additionalFileBlock-"+$dataId).replaceWith(json.html);
							else $clicked.after(json.html);
						}
						$("a.fancy").fancybox();
						$("*[id^='admimg']").upload();
					}
				}
			}, "json");
		}	
		$clicked.removeClass("disabled");		
	}
});
//upload
(function(){var h=document,l=window;function b(d){if(typeof d=="string"){d=h.getElementById(d)}return d}function e(q,p,d){if(l.addEventListener){q.addEventListener(p,d,false)}else{if(l.attachEvent){var r=function(){d.call(q,l.event)};q.attachEvent("on"+p,r)}}}var c=function(){var d=h.createElement("div");return function(p){d.innerHTML=p;var q=d.childNodes[0];d.removeChild(q);return q}}();function f(p,d){return p.className.match(new RegExp("(\\s|^)"+d+"(\\s|$)"))}function g(p,d){if(!f(p,d)){p.className+=" "+d}}function m(q,d){var p=new RegExp("(\\s|^)"+d+"(\\s|$)");q.className=q.className.replace(p," ")}if(document.documentElement.getBoundingClientRect){var n=function(d){var t=d.getBoundingClientRect(),x=d.ownerDocument,u=x.body,p=x.documentElement,s=p.clientTop||u.clientTop||0,v=p.clientLeft||u.clientLeft||0,y=1;if(u.getBoundingClientRect){var r=u.getBoundingClientRect();y=(r.right-r.left)/u.clientWidth}if(y>1){s=0;v=0}var w=t.top/y+(window.pageYOffset||p&&p.scrollTop/y||u.scrollTop/y)-s,q=t.left/y+(window.pageXOffset||p&&p.scrollLeft/y||u.scrollLeft/y)-v;return{top:w,left:q}}}else{var n=function(d){if(l.jQuery){return jQuery(d).offset()}var q=0,p=0;do{q+=d.offsetTop||0;p+=d.offsetLeft||0}while(d=d.offsetParent);return{left:p,top:q}}}function a(q){var s,p,r,d;var t=n(q);s=t.left;r=t.top;p=s+q.offsetWidth;d=r+q.offsetHeight;return{left:s,right:p,top:r,bottom:d}}function j(r){if(!r.pageX&&r.clientX){var q=1;var d=document.body;if(d.getBoundingClientRect){var p=d.getBoundingClientRect();q=(p.right-p.left)/d.clientWidth}return{x:r.clientX/q+h.body.scrollLeft+h.documentElement.scrollLeft,y:r.clientY/q+h.body.scrollTop+h.documentElement.scrollTop}}return{x:r.pageX,y:r.pageY}}var i=function(){var d=0;return function(){return"ValumsAjaxUpload"+d++}}();function o(d){return d.replace(/.*(\/|\\)/,"")}function k(d){return(/[.]/.exec(d))?/[^.]+$/.exec(d.toLowerCase()):""}Ajax_upload=AjaxUpload=function(q,d){if(q.jquery){q=q[0]}else{if(typeof q=="string"&&/^#.*/.test(q)){q=q.slice(1)}}q=b(q);this._input=null;this._button=q;this._disabled=false;this._submitting=false;this._justClicked=false;this._parentDialog=h.body;if(window.jQuery&&jQuery.ui&&jQuery.ui.dialog){var r=jQuery(this._button).parents(".ui-dialog");if(r.length){this._parentDialog=r[0]}}this._settings={action:"upload.php",name:"userfile",id:"",data:{},autoSubmit:true,responseType:false,onChange:function(s,t){},onSubmit:function(s,t){},onComplete:function(t,s){}};for(var p in d){this._settings[p]=d[p]}this._createInput();this._rerouteClicks()};AjaxUpload.prototype={setData:function(d){this._settings.data=d},disable:function(){this._disabled=true},enable:function(){this._disabled=false},destroy:function(){if(this._input){if(this._input.parentNode){this._input.parentNode.removeChild(this._input)}this._input=null}},_createInput:function(){var p=this;var d=h.createElement("input");d.setAttribute("type","file");d.setAttribute("id","upfield-"+this._settings.id+this._settings.type+this._settings.imgType);d.setAttribute("name",this._settings.name);var r={position:"absolute",margin:"-5px 0 0 -175px",padding:0,width:"220px",height:"30px",fontSize:"14px",opacity:0,cursor:"pointer!important",display:"none",zIndex:100};for(var q in r){d.style[q]=r[q]}if(!(d.style.opacity==="0")){d.style.filter="alpha(opacity=0)"}this._parentDialog.appendChild(d);e(d,"change",function(){var s=o(this.value);if(p._settings.onChange.call(p,s,k(s))==false){return}if(p._settings.autoSubmit){p.submit()}});e(d,"click",function(){p.justClicked=true;setTimeout(function(){p.justClicked=false},1000)});this._input=d},_rerouteClicks:function(){var p=this;var q,d={top:0,left:0},r=false;e(p._button,"mouseover",function(s){if(!p._input||r){return}r=true;q=a(p._button);if(p._parentDialog!=h.body){d=n(p._parentDialog)}});e(document,"mousemove",function(t){var s=p._input;if(!s||!r){return}if(p._disabled){m(p._button,"");s.style.display="none";return}var u=j(t);if((u.x>=q.left)&&(u.x<=q.right)&&(u.y>=q.top)&&(u.y<=q.bottom)){s.style.top=u.y-d.top+"px";s.style.left=u.x-d.left+"px";s.style.display="block";g(p._button,"")}else{r=false;if(!p.justClicked){s.style.display="none"}m(p._button,"")}})},_createIframe:function(){var p=i();var d=c('<iframe src="javascript:false;" name="'+p+'" />');d.id=p;d.style.display="none";h.body.appendChild(d);return d},submit:function(){var d=this,r=this._settings;if(this._input.value===""){return}var p=o(this._input.value);if(!(r.onSubmit.call(this,p,k(p))==false)){var q=this._createIframe();var t=this._createForm(q);t.appendChild(this._input);t.submit();h.body.removeChild(t);t=null;this._input=null;this._createInput();var s=false;e(q,"load",function(w){if(q.src=="javascript:'%3Chtml%3E%3C/html%3E';"||q.src=="javascript:'<html></html>';"){if(s){setTimeout(function(){h.body.removeChild(q)},0)}return}var v=q.contentDocument?q.contentDocument:frames[q.id].document;if(v.readyState&&v.readyState!="complete"){return}if(v.body&&v.body.innerHTML=="false"){return}var u;if(v.XMLDocument){u=v.XMLDocument}else{if(v.body){u=v.body.innerHTML;if(r.responseType&&r.responseType.toLowerCase()=="json"){if(v.body.firstChild&&v.body.firstChild.nodeName.toUpperCase()=="PRE"){u=v.body.firstChild.firstChild.nodeValue}if(u){u=window["eval"]("("+u+")")}else{u={}}}}else{var u=v}}r.onComplete.call(d,p,u);s=true;q.src="javascript:'<html></html>';"})}else{h.body.removeChild(this._input);this._input=null;this._createInput()}},_createForm:function(q){var p=this._settings;var r=c('<form method="post" enctype="multipart/form-data"></form>');r.style.display="none";r.action=p.action;r.target=q.name;h.body.appendChild(r);for(var s in p.data){var d=h.createElement("input");d.type="hidden";d.name=s;d.value=p.data[s];r.appendChild(d)}return r}}})();
//json
(function($){function toIntegersAtLease(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(date){return this.getUTCFullYear()+"-"+toIntegersAtLease(this.getUTCMonth())+"-"+toIntegersAtLease(this.getUTCDate())};var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};$.quoteString=function(string){if(escapeable.test(string)){return'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+string+'"'};$.toJSON=function(o,compact){var type=typeof(o);if(type=="undefined"){return"undefined"}else{if(type=="number"||type=="boolean"){return o+""}else{if(o===null){return"null"}}}if(type=="string"){return $.quoteString(o)}if(type=="object"&&typeof o.toJSON=="function"){return o.toJSON(compact)}if(type!="function"&&typeof(o.length)=="number"){var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i],compact))}if(compact){return"["+ret.join(",")+"]"}else{return"["+ret.join(", ")+"]"}}if(type=="function"){throw new TypeError("Unable to convert object of type 'function' to json.")}var ret=[];for(var k in o){var name;type=typeof(k);if(type=="number"){name='"'+k+'"'}else{if(type=="string"){name=$.quoteString(k)}else{continue}}var val=$.toJSON(o[k],compact);if(typeof(val)!="string"){continue}if(compact){ret.push(name+":"+val)}else{ret.push(name+": "+val)}}return"{"+ret.join(", ")+"}"};$.compactJSON=function(o){return $.toJSON(o,true)};$.evalJSON=function(src){return eval("("+src+")")};$.secureEvalJSON=function(src){var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@");filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+src+")")}else{throw new SyntaxError("Error parsing JSON, source is not valid.")}}})(jQuery);
//dialogue
jQuery.ui||(function(p){var j=p.fn.remove,o=p.browser.mozilla&&(parseFloat(p.browser.version)<1.9);p.ui={version:"1.7.2",plugin:{add:function(c,b,e){var a=p.ui[c].prototype;for(var d in e){a.plugins[d]=a.plugins[d]||[];a.plugins[d].push([b,e[d]])}},call:function(d,b,c){var e=d.plugins[b];if(!e||!d.element[0].parentNode){return}for(var a=0;a<e.length;a++){if(d.options[e[a][0]]){e[a][1].apply(d.element,c)}}}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(a,c){if(p(a).css("overflow")=="hidden"){return false}var d=(c&&c=="left")?"scrollLeft":"scrollTop",b=false;if(a[d]>0){return true}a[d]=1;b=(a[d]>0);a[d]=0;return b},isOverAxis:function(b,c,a){return(b>c)&&(b<(c+a))},isOver:function(e,c,f,a,d,b){return p.ui.isOverAxis(e,f,d)&&p.ui.isOverAxis(c,a,b)},keyCode:{BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}};if(o){var m=p.attr,n=p.fn.removeAttr,k="http://www.w3.org/2005/07/aaa",r=/^aria-/,q=/^wairole:/;p.attr=function(c,d,b){var a=b!==undefined;return(d=="role"?(a?m.call(this,c,d,"wairole:"+b):(m.apply(this,arguments)||"").replace(q,"")):(r.test(d)?(a?c.setAttributeNS(k,d.replace(r,"aaa:"),b):m.call(this,c,d.replace(r,"aaa:"))):m.apply(this,arguments)))};p.fn.removeAttr=function(a){return(r.test(a)?this.each(function(){this.removeAttributeNS(k,a.replace(r,""))}):n.call(this,a))}}p.fn.extend({remove:function(){p("*",this).add(this).each(function(){p(this).triggerHandler("remove")});return j.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false})},scrollParent:function(){var a;if((p.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){a=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(p.curCSS(this,"position",1))&&(/(auto|scroll)/).test(p.curCSS(this,"overflow",1)+p.curCSS(this,"overflow-y",1)+p.curCSS(this,"overflow-x",1))}).eq(0)}else{a=this.parents().filter(function(){return(/(auto|scroll)/).test(p.curCSS(this,"overflow",1)+p.curCSS(this,"overflow-y",1)+p.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!a.length?p(document):a}});p.extend(p.expr[":"],{data:function(a,b,c){return !!p.data(a,c[3])},focusable:function(b){var a=b.nodeName.toLowerCase(),c=p.attr(b,"tabindex");return(/input|select|textarea|button|object/.test(a)?!b.disabled:"a"==a||"area"==a?b.href||!isNaN(c):!isNaN(c))&&!p(b)["area"==a?"parents":"closest"](":hidden").length},tabbable:function(a){var b=p.attr(a,"tabindex");return(isNaN(b)||b>=0)&&p(a).is(":focusable")}});function l(a,f,e,b){function c(g){var h=p[a][f][g]||[];return(typeof h=="string"?h.split(/,?\s+/):h)}var d=c("getter");if(b.length==1&&typeof b[0]=="string"){d=d.concat(c("getterSetter"))}return(p.inArray(e,d)!=-1)}p.widget=function(b,c){var a=b.split(".")[0];b=b.split(".")[1];p.fn[b]=function(e){var g=(typeof e=="string"),f=Array.prototype.slice.call(arguments,1);if(g&&e.substring(0,1)=="_"){return this}if(g&&l(a,b,e,f)){var d=p.data(this[0],b);return(d?d[e].apply(d,f):undefined)}return this.each(function(){var h=p.data(this,b);(!h&&!g&&p.data(this,b,new p[a][b](this,e))._init());(h&&g&&p.isFunction(h[e])&&h[e].apply(h,f))})};p[a]=p[a]||{};p[a][b]=function(e,f){var d=this;this.namespace=a;this.widgetName=b;this.widgetEventPrefix=p[a][b].eventPrefix||b;this.widgetBaseClass=a+"-"+b;this.options=p.extend({},p.widget.defaults,p[a][b].defaults,p.metadata&&p.metadata.get(e)[b],f);this.element=p(e).bind("setData."+b,function(h,i,g){if(h.target==e){return d._setData(i,g)}}).bind("getData."+b,function(g,h){if(g.target==e){return d._getData(h)}}).bind("remove",function(){return d.destroy()})};p[a][b].prototype=p.extend({},p.widget.prototype,c);p[a][b].getterSetter="option"};p.widget.prototype={_init:function(){},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled")},option:function(b,a){var c=b,d=this;if(typeof b=="string"){if(a===undefined){return this._getData(b)}c={};c[b]=a}p.each(c,function(f,e){d._setData(f,e)})},_getData:function(a){return this.options[a]},_setData:function(b,a){this.options[b]=a;if(b=="disabled"){this.element[a?"addClass":"removeClass"](this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",a)}},enable:function(){this._setData("disabled",false)},disable:function(){this._setData("disabled",true)},_trigger:function(b,a,g){var e=this.options[b],d=(b==this.widgetEventPrefix?b:this.widgetEventPrefix+b);a=p.Event(a);a.type=d;if(a.originalEvent){for(var c=p.event.props.length,f;c;){f=p.event.props[--c];a[f]=a.originalEvent[f]}}this.element.trigger(a,g);return !(p.isFunction(e)&&e.call(this.element[0],a,g)===false||a.isDefaultPrevented())}};p.widget.defaults={disabled:false};p.ui.mouse={_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(b){return a._mouseDown(b)}).bind("click."+this.widgetName,function(b){if(a._preventClickEvent){a._preventClickEvent=false;b.stopImmediatePropagation();return false}});if(p.browser.msie){this._mouseUnselectable=this.element.attr("unselectable");this.element.attr("unselectable","on")}this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);(p.browser.msie&&this.element.attr("unselectable",this._mouseUnselectable))},_mouseDown:function(b){b.originalEvent=b.originalEvent||{};if(b.originalEvent.mouseHandled){return}(this._mouseStarted&&this._mouseUp(b));this._mouseDownEvent=b;var c=this,a=(b.which==1),d=(typeof this.options.cancel=="string"?p(b.target).parents().add(b.target).filter(this.options.cancel).length:false);if(!a||d||!this._mouseCapture(b)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=(this._mouseStart(b)!==false);if(!this._mouseStarted){b.preventDefault();return true}}this._mouseMoveDelegate=function(e){return c._mouseMove(e)};this._mouseUpDelegate=function(e){return c._mouseUp(e)};p(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);(p.browser.safari||b.preventDefault());b.originalEvent.mouseHandled=true;return true},_mouseMove:function(a){if(p.browser.msie&&!a.button){return this._mouseUp(a)}if(this._mouseStarted){this._mouseDrag(a);return a.preventDefault()}if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,a)!==false);(this._mouseStarted?this._mouseDrag(a):this._mouseUp(a))}return !this._mouseStarted},_mouseUp:function(a){p(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=(a.target==this._mouseDownEvent.target);this._mouseStop(a)}return false},_mouseDistanceMet:function(a){return(Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance)},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return true}};p.ui.mouse.defaults={cancel:null,distance:1,delay:0}})(jQuery);(function(b){b.widget("ui.draggable",b.extend({},b.ui.mouse,{_init:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(a){var d=this.options;if(this.helper||d.disabled||b(a.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(a);if(!this.handle){return false}return true},_mouseStart:function(a){var d=this.options;this.helper=this._createHelper(a);this._cacheHelperProportions();if(b.ui.ddmanager){b.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};b.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;if(d.cursorAt){this._adjustOffsetFromHelper(d.cursorAt)}if(d.containment){this._setContainment()}this._trigger("start",a);this._cacheHelperProportions();if(b.ui.ddmanager&&!d.dropBehaviour){b.ui.ddmanager.prepareOffsets(this,a)}this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,true);return true},_mouseDrag:function(a,e){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!e){var f=this._uiHash();this._trigger("drag",a,f);this.position=f.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(b.ui.ddmanager){b.ui.ddmanager.drag(this,a)}return false},_mouseStop:function(f){var e=false;if(b.ui.ddmanager&&!this.options.dropBehaviour){e=b.ui.ddmanager.drop(this,f)}if(this.dropped){e=this.dropped;this.dropped=false}if((this.options.revert=="invalid"&&!e)||(this.options.revert=="valid"&&e)||this.options.revert===true||(b.isFunction(this.options.revert)&&this.options.revert.call(this.element,e))){var a=this;b(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){a._trigger("stop",f);a._clear()})}else{this._trigger("stop",f);this._clear()}return false},_getHandle:function(a){var d=!this.options.handle||!b(this.options.handle,this.element).length?true:false;b(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==a.target){d=true}});return d},_createHelper:function(f){var e=this.options;var a=b.isFunction(e.helper)?b(e.helper.apply(this.element[0],[f])):(e.helper=="clone"?this.element.clone():this.element);if(!a.parents("body").length){a.appendTo((e.appendTo=="parent"?this.element[0].parentNode:e.appendTo))}if(a[0]!=this.element[0]&&!(/(fixed|absolute)/).test(a.css("position"))){a.css("position","absolute")}return a},_adjustOffsetFromHelper:function(a){if(a.left!=undefined){this.offset.click.left=a.left+this.margins.left}if(a.right!=undefined){this.offset.click.left=this.helperProportions.width-a.right+this.margins.left}if(a.top!=undefined){this.offset.click.top=a.top+this.margins.top}if(a.bottom!=undefined){this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&b.browser.msie)){a={top:0,left:0}}return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f=this.options;if(f.containment=="parent"){f.containment=this.helper[0].parentNode}if(f.containment=="document"||f.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,b(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(f.containment)&&f.containment.constructor!=Array){var h=b(f.containment)[0];if(!h){return}var g=b(f.containment).offset();var a=(b(h).css("overflow")!="hidden");this.containment=[g.left+(parseInt(b(h).css("borderLeftWidth"),10)||0)+(parseInt(b(h).css("paddingLeft"),10)||0)-this.margins.left,g.top+(parseInt(b(h).css("borderTopWidth"),10)||0)+(parseInt(b(h).css("paddingTop"),10)||0)-this.margins.top,g.left+(a?Math.max(h.scrollWidth,h.offsetWidth):h.offsetWidth)-(parseInt(b(h).css("borderLeftWidth"),10)||0)-(parseInt(b(h).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,g.top+(a?Math.max(h.scrollHeight,h.offsetHeight):h.offsetHeight)-(parseInt(b(h).css("borderTopWidth"),10)||0)-(parseInt(b(h).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}else{if(f.containment.constructor==Array){this.containment=f.containment}}},_convertPositionTo:function(j,d){if(!d){d=this.position}var l=j=="absolute"?1:-1;var k=this.options,a=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,i=(/(html|body)/i).test(a[0].tagName);return{top:(d.top+this.offset.relative.top*l+this.offset.parent.top*l-(b.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(i?0:a.scrollTop()))*l)),left:(d.left+this.offset.relative.left*l+this.offset.parent.left*l-(b.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:a.scrollLeft())*l))}},_generatePosition:function(n){var k=this.options,a=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=(/(html|body)/i).test(a[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var o=n.pageX;var p=n.pageY;if(this.originalPosition){if(this.containment){if(n.pageX-this.offset.click.left<this.containment[0]){o=this.containment[0]+this.offset.click.left}if(n.pageY-this.offset.click.top<this.containment[1]){p=this.containment[1]+this.offset.click.top}if(n.pageX-this.offset.click.left>this.containment[2]){o=this.containment[2]+this.offset.click.left}if(n.pageY-this.offset.click.top>this.containment[3]){p=this.containment[3]+this.offset.click.top}}if(k.grid){var l=this.originalPageY+Math.round((p-this.originalPageY)/k.grid[1])*k.grid[1];p=this.containment?(!(l-this.offset.click.top<this.containment[1]||l-this.offset.click.top>this.containment[3])?l:(!(l-this.offset.click.top<this.containment[1])?l-k.grid[1]:l+k.grid[1])):l;var m=this.originalPageX+Math.round((o-this.originalPageX)/k.grid[0])*k.grid[0];o=this.containment?(!(m-this.offset.click.left<this.containment[0]||m-this.offset.click.left>this.containment[2])?m:(!(m-this.offset.click.left<this.containment[0])?m-k.grid[0]:m+k.grid[0])):m}}return{top:(p-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(b.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(j?0:a.scrollTop())))),left:(o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(b.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:a.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(a,f,e){e=e||this._uiHash();b.ui.plugin.call(this,a,[f,e]);if(a=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return b.widget.prototype._trigger.call(this,a,f,e)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,absolutePosition:this.positionAbs,offset:this.positionAbs}}}));b.extend(b.ui.draggable,{version:"1.7.2",eventPrefix:"drag",defaults:{addClasses:true,appendTo:"parent",axis:false,cancel:":input,option",connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,delay:0,distance:1,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false}});b.ui.plugin.add("draggable","connectToSortable",{start:function(j,h){var i=b(this).data("draggable"),g=i.options,a=b.extend({},h,{item:i.element});i.sortables=[];b(g.connectToSortable).each(function(){var c=b.data(this,"sortable");if(c&&!c.options.disabled){i.sortables.push({instance:c,shouldRevert:c.options.revert});c._refreshItems();c._trigger("activate",j,a)}})},stop:function(h,f){var g=b(this).data("draggable"),a=b.extend({},f,{item:g.element});b.each(g.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;g.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(h);this.instance.options.helper=this.instance.options._helper;if(g.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",h,a)}})},drag:function(j,g){var h=b(this).data("draggable"),a=this;var i=function(r){var d=this.offset.click.top,e=this.offset.click.left;var t=this.positionAbs.top,o=this.positionAbs.left;var q=r.height,f=r.width;var c=r.top,s=r.left;return b.ui.isOver(t+d,o+e,c,s,q,f)};b.each(h.sortables,function(c){this.instance.positionAbs=h.positionAbs;this.instance.helperProportions=h.helperProportions;this.instance.offset.click=h.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=b(a).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return g.helper[0]};j.target=this.instance.currentItem[0];this.instance._mouseCapture(j,true);this.instance._mouseStart(j,true,true);this.instance.offset.click.top=h.offset.click.top;this.instance.offset.click.left=h.offset.click.left;this.instance.offset.parent.left-=h.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=h.offset.parent.top-this.instance.offset.parent.top;h._trigger("toSortable",j);h.dropped=this.instance.element;h.currentItem=h.element;this.instance.fromOutside=h}if(this.instance.currentItem){this.instance._mouseDrag(j)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",j,this.instance._uiHash(this.instance));this.instance._mouseStop(j,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}h._trigger("fromSortable",j);h.dropped=false}}})}});b.ui.plugin.add("draggable","cursor",{start:function(h,g){var a=b("body"),f=b(this).data("draggable").options;if(a.css("cursor")){f._cursor=a.css("cursor")}a.css("cursor",f.cursor)},stop:function(a,f){var e=b(this).data("draggable").options;if(e._cursor){b("body").css("cursor",e._cursor)}}});b.ui.plugin.add("draggable","iframeFix",{start:function(a,f){var e=b(this).data("draggable").options;b(e.iframeFix===true?"iframe":e.iframeFix).each(function(){b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(b(this).offset()).appendTo("body")})},stop:function(a,d){b("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});b.ui.plugin.add("draggable","opacity",{start:function(h,g){var a=b(g.helper),f=b(this).data("draggable").options;if(a.css("opacity")){f._opacity=a.css("opacity")}a.css("opacity",f.opacity)},stop:function(a,f){var e=b(this).data("draggable").options;if(e._opacity){b(f.helper).css("opacity",e._opacity)}}});b.ui.plugin.add("draggable","scroll",{start:function(f,e){var a=b(this).data("draggable");if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML"){a.overflowOffset=a.scrollParent.offset()}},drag:function(i,h){var j=b(this).data("draggable"),g=j.options,a=false;if(j.scrollParent[0]!=document&&j.scrollParent[0].tagName!="HTML"){if(!g.axis||g.axis!="x"){if((j.overflowOffset.top+j.scrollParent[0].offsetHeight)-i.pageY<g.scrollSensitivity){j.scrollParent[0].scrollTop=a=j.scrollParent[0].scrollTop+g.scrollSpeed}else{if(i.pageY-j.overflowOffset.top<g.scrollSensitivity){j.scrollParent[0].scrollTop=a=j.scrollParent[0].scrollTop-g.scrollSpeed}}}if(!g.axis||g.axis!="y"){if((j.overflowOffset.left+j.scrollParent[0].offsetWidth)-i.pageX<g.scrollSensitivity){j.scrollParent[0].scrollLeft=a=j.scrollParent[0].scrollLeft+g.scrollSpeed}else{if(i.pageX-j.overflowOffset.left<g.scrollSensitivity){j.scrollParent[0].scrollLeft=a=j.scrollParent[0].scrollLeft-g.scrollSpeed}}}}else{if(!g.axis||g.axis!="x"){if(i.pageY-b(document).scrollTop()<g.scrollSensitivity){a=b(document).scrollTop(b(document).scrollTop()-g.scrollSpeed)}else{if(b(window).height()-(i.pageY-b(document).scrollTop())<g.scrollSensitivity){a=b(document).scrollTop(b(document).scrollTop()+g.scrollSpeed)}}}if(!g.axis||g.axis!="y"){if(i.pageX-b(document).scrollLeft()<g.scrollSensitivity){a=b(document).scrollLeft(b(document).scrollLeft()-g.scrollSpeed)}else{if(b(window).width()-(i.pageX-b(document).scrollLeft())<g.scrollSensitivity){a=b(document).scrollLeft(b(document).scrollLeft()+g.scrollSpeed)}}}}if(a!==false&&b.ui.ddmanager&&!g.dropBehaviour){b.ui.ddmanager.prepareOffsets(j,i)}}});b.ui.plugin.add("draggable","snap",{start:function(h,g){var a=b(this).data("draggable"),f=a.options;a.snapElements=[];b(f.snap.constructor!=String?(f.snap.items||":data(draggable)"):f.snap).each(function(){var c=b(this);var d=c.offset();if(this!=a.element[0]){a.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})}})},drag:function(r,D){var J=b(this).data("draggable"),B=J.options;var d=B.snapTolerance;var i=D.offset.left,l=i+J.helperProportions.width,K=D.offset.top,L=K+J.helperProportions.height;for(var o=J.snapElements.length-1;o>=0;o--){var t=J.snapElements[o].left,E=t+J.snapElements[o].width,F=J.snapElements[o].top,C=F+J.snapElements[o].height;if(!((t-d<i&&i<E+d&&F-d<K&&K<C+d)||(t-d<i&&i<E+d&&F-d<L&&L<C+d)||(t-d<l&&l<E+d&&F-d<K&&K<C+d)||(t-d<l&&l<E+d&&F-d<L&&L<C+d))){if(J.snapElements[o].snapping){(J.options.snap.release&&J.options.snap.release.call(J.element,r,b.extend(J._uiHash(),{snapItem:J.snapElements[o].item})))}J.snapElements[o].snapping=false;continue}if(B.snapMode!="inner"){var M=Math.abs(F-L)<=d;var a=Math.abs(C-K)<=d;var H=Math.abs(t-l)<=d;var G=Math.abs(E-i)<=d;if(M){D.position.top=J._convertPositionTo("relative",{top:F-J.helperProportions.height,left:0}).top-J.margins.top}if(a){D.position.top=J._convertPositionTo("relative",{top:C,left:0}).top-J.margins.top}if(H){D.position.left=J._convertPositionTo("relative",{top:0,left:t-J.helperProportions.width}).left-J.margins.left}if(G){D.position.left=J._convertPositionTo("relative",{top:0,left:E}).left-J.margins.left}}var I=(M||a||H||G);if(B.snapMode!="outer"){var M=Math.abs(F-K)<=d;var a=Math.abs(C-L)<=d;var H=Math.abs(t-i)<=d;var G=Math.abs(E-l)<=d;if(M){D.position.top=J._convertPositionTo("relative",{top:F,left:0}).top-J.margins.top}if(a){D.position.top=J._convertPositionTo("relative",{top:C-J.helperProportions.height,left:0}).top-J.margins.top}if(H){D.position.left=J._convertPositionTo("relative",{top:0,left:t}).left-J.margins.left}if(G){D.position.left=J._convertPositionTo("relative",{top:0,left:E-J.helperProportions.width}).left-J.margins.left}}if(!J.snapElements[o].snapping&&(M||a||H||G||I)){(J.options.snap.snap&&J.options.snap.snap.call(J.element,r,b.extend(J._uiHash(),{snapItem:J.snapElements[o].item})))}J.snapElements[o].snapping=(M||a||H||G||I)}}});b.ui.plugin.add("draggable","stack",{start:function(a,h){var f=b(this).data("draggable").options;var g=b.makeArray(b(f.stack.group)).sort(function(c,d){return(parseInt(b(c).css("zIndex"),10)||f.stack.min)-(parseInt(b(d).css("zIndex"),10)||f.stack.min)});b(g).each(function(c){this.style.zIndex=f.stack.min+c});this[0].style.zIndex=f.stack.min+g.length}});b.ui.plugin.add("draggable","zIndex",{start:function(h,g){var a=b(g.helper),f=b(this).data("draggable").options;if(a.css("zIndex")){f._zIndex=a.css("zIndex")}a.css("zIndex",f.zIndex)},stop:function(a,f){var e=b(this).data("draggable").options;if(e._zIndex){b(f.helper).css("zIndex",e._zIndex)}}})})(jQuery);(function(f){f.widget("ui.resizable",f.extend({},f.ui.mouse,{_init:function(){var m=this,b=this.options;this.element.addClass("ui-resizable");f.extend(this,{_aspectRatio:!!(b.aspectRatio),aspectRatio:b.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:b.helper||b.ghost||b.animate?b.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){if(/relative/.test(this.element.css("position"))&&f.browser.opera){this.element.css({position:"relative",top:"auto",left:"auto"})}this.element.wrap(f('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=b.handles||(!f(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var a=this.handles.split(",");this.handles={};for(var l=0;l<a.length;l++){var c=f.trim(a[l]),n="ui-resizable-"+c;var i=f('<div class="ui-resizable-handle '+n+'"></div>');if(/sw|se|ne|nw/.test(c)){i.css({zIndex:++b.zIndex})}if("se"==c){i.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[c]=".ui-resizable-"+c;this.element.append(i)}}this._renderAxis=function(j){j=j||this.element;for(var g in this.handles){if(this.handles[g].constructor==String){this.handles[g]=f(this.handles[g],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var q=f(this.handles[g],this.element),k=0;k=/sw|ne|nw|se|n|s/.test(g)?q.outerHeight():q.outerWidth();var h=["padding",/ne|nw|n/.test(g)?"Top":/se|sw|s/.test(g)?"Bottom":/^e$/.test(g)?"Right":"Left"].join("");j.css(h,k);this._proportionallyResize()}if(!f(this.handles[g]).length){continue}}};this._renderAxis(this.element);this._handles=f(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!m.resizing){if(this.className){var g=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}m.axis=g&&g[1]?g[1]:"se"}});if(b.autoHide){this._handles.hide();f(this.element).addClass("ui-resizable-autohide").hover(function(){f(this).removeClass("ui-resizable-autohide");m._handles.show()},function(){if(!m.resizing){f(this).addClass("ui-resizable-autohide");m._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(c){f(c).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var a=this.element;a.parent().append(this.originalElement.css({position:a.css("position"),width:a.outerWidth(),height:a.outerHeight(),top:a.css("top"),left:a.css("left")})).end().remove()}this.originalElement.css("resize",this.originalResizeStyle);b(this.originalElement)},_mouseCapture:function(b){var a=false;for(var c in this.handles){if(f(this.handles[c])[0]==b.target){a=true}}return this.options.disabled||!!a},_mouseStart:function(l){var b=this.options,m=this.element.position(),n=this.element;this.resizing=true;this.documentScroll={top:f(document).scrollTop(),left:f(document).scrollLeft()};if(n.is(".ui-draggable")||(/absolute/).test(n.css("position"))){n.css({position:"absolute",top:m.top,left:m.left})}if(f.browser.opera&&(/relative/).test(n.css("position"))){n.css({position:"relative",top:"auto",left:"auto"})}this._renderProxy();var a=d(this.helper.css("left")),k=d(this.helper.css("top"));if(b.containment){a+=f(b.containment).scrollLeft()||0;k+=f(b.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:a,top:k};this.size=this._helper?{width:n.outerWidth(),height:n.outerHeight()}:{width:n.width(),height:n.height()};this.originalSize=this._helper?{width:n.outerWidth(),height:n.outerHeight()}:{width:n.width(),height:n.height()};this.originalPosition={left:a,top:k};this.sizeDiff={width:n.outerWidth()-n.width(),height:n.outerHeight()-n.height()};this.originalMousePosition={left:l.pageX,top:l.pageY};this.aspectRatio=(typeof b.aspectRatio=="number")?b.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var c=f(".ui-resizable-"+this.axis).css("cursor");f("body").css("cursor",c=="auto"?this.axis+"-resize":c);n.addClass("ui-resizable-resizing");this._propagate("start",l);return true},_mouseDrag:function(z){var w=this.helper,x=this.options,r={},b=this,u=this.originalMousePosition,o=this.axis;var a=(z.pageX-u.left)||0,c=(z.pageY-u.top)||0;var v=this._change[o];if(!v){return false}var s=v.apply(this,[z,a,c]),t=f.browser.msie&&f.browser.version<7,y=this.sizeDiff;if(this._aspectRatio||z.shiftKey){s=this._updateRatio(s,z)}s=this._respectSize(s,z);this._propagate("resize",z);w.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(s);this._trigger("resize",z,this.ui());return false},_mouseStop:function(q){this.resizing=false;var p=this.options,b=this;if(this._helper){var r=this._proportionallyResizeElements,t=r.length&&(/textarea/i).test(r[0].nodeName),s=t&&f.ui.hasScroll(r[0],"left")?0:b.sizeDiff.height,n=t?0:b.sizeDiff.width;var a={width:(b.size.width-n),height:(b.size.height-s)},o=(parseInt(b.element.css("left"),10)+(b.position.left-b.originalPosition.left))||null,c=(parseInt(b.element.css("top"),10)+(b.position.top-b.originalPosition.top))||null;if(!p.animate){this.element.css(f.extend(a,{top:c,left:o}))}b.helper.height(b.size.height);b.helper.width(b.size.width);if(this._helper&&!p.animate){this._proportionallyResize()}}f("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",q);if(this._helper){this.helper.remove()}return false},_updateCache:function(b){var a=this.options;this.offset=this.helper.offset();if(e(b.left)){this.position.left=b.left}if(e(b.top)){this.position.top=b.top}if(e(b.height)){this.size.height=b.height}if(e(b.width)){this.size.width=b.width}},_updateRatio:function(c,j){var b=this.options,a=this.position,k=this.size,l=this.axis;if(c.height){c.width=(k.height*this.aspectRatio)}else{if(c.width){c.height=(k.width/this.aspectRatio)}}if(l=="sw"){c.left=a.left+(k.width-c.width);c.top=null}if(l=="nw"){c.top=a.top+(k.height-c.height);c.left=a.left+(k.width-c.width)}return c},_respectSize:function(v,A){var x=this.helper,y=this.options,b=this._aspectRatio||A.shiftKey,c=this.axis,D=e(v.width)&&y.maxWidth&&(y.maxWidth<v.width),u=e(v.height)&&y.maxHeight&&(y.maxHeight<v.height),z=e(v.width)&&y.minWidth&&(y.minWidth>v.width),a=e(v.height)&&y.minHeight&&(y.minHeight>v.height);if(z){v.width=y.minWidth}if(a){v.height=y.minHeight}if(D){v.width=y.maxWidth}if(u){v.height=y.maxHeight}var B=this.originalPosition.left+this.originalSize.width,o=this.position.top+this.size.height;var w=/sw|nw|w/.test(c),C=/nw|ne|n/.test(c);if(z&&w){v.left=B-y.minWidth}if(D&&w){v.left=B-y.maxWidth}if(a&&C){v.top=o-y.minHeight}if(u&&C){v.top=o-y.maxHeight}var t=!v.width&&!v.height;if(t&&!v.left&&v.top){v.top=null}else{if(t&&!v.top&&v.left){v.left=null}}return v},_proportionallyResize:function(){var a=this.options;if(!this._proportionallyResizeElements.length){return}var i=this.helper||this.element;for(var k=0;k<this._proportionallyResizeElements.length;k++){var c=this._proportionallyResizeElements[k];if(!this.borderDif){var l=[c.css("borderTopWidth"),c.css("borderRightWidth"),c.css("borderBottomWidth"),c.css("borderLeftWidth")],b=[c.css("paddingTop"),c.css("paddingRight"),c.css("paddingBottom"),c.css("paddingLeft")];this.borderDif=f.map(l,function(j,g){var h=parseInt(j,10)||0,o=parseInt(b[g],10)||0;return h+o})}if(f.browser.msie&&!(!(f(i).is(":hidden")||f(i).parents(":hidden").length))){continue}c.css({height:(i.height()-this.borderDif[0]-this.borderDif[2])||0,width:(i.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var i=this.element,a=this.options;this.elementOffset=i.offset();if(this._helper){this.helper=this.helper||f('<div style="overflow:hidden;"></div>');var j=f.browser.msie&&f.browser.version<7,c=(j?1:0),b=(j?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+b,height:this.element.outerHeight()+b,position:"absolute",left:this.elementOffset.left-c+"px",top:this.elementOffset.top-c+"px",zIndex:++a.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(a,b,c){return{width:this.originalSize.width+b}},w:function(c,k,l){var a=this.options,j=this.originalSize,b=this.originalPosition;return{left:b.left+k,width:j.width-k}},n:function(c,k,l){var a=this.options,j=this.originalSize,b=this.originalPosition;return{top:b.top+l,height:j.height-l}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(a,b,c){return f.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[a,b,c]))},sw:function(a,b,c){return f.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[a,b,c]))},ne:function(a,b,c){return f.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[a,b,c]))},nw:function(a,b,c){return f.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[a,b,c]))}},_propagate:function(a,b){f.ui.plugin.call(this,a,[b,this.ui()]);(a!="resize"&&this._trigger(a,b,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}));f.extend(f.ui.resizable,{version:"1.7.2",eventPrefix:"resize",defaults:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,cancel:":input,option",containment:false,delay:0,distance:1,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000}});f.ui.plugin.add("resizable","alsoResize",{start:function(c,b){var h=f(this).data("resizable"),a=h.options;_store=function(g){f(g).each(function(){f(this).data("resizable-alsoresize",{width:parseInt(f(this).width(),10),height:parseInt(f(this).height(),10),left:parseInt(f(this).css("left"),10),top:parseInt(f(this).css("top"),10)})})};if(typeof(a.alsoResize)=="object"&&!a.alsoResize.parentNode){if(a.alsoResize.length){a.alsoResize=a.alsoResize[0];_store(a.alsoResize)}else{f.each(a.alsoResize,function(j,g){_store(j)})}}else{_store(a.alsoResize)}},resize:function(n,l){var o=f(this).data("resizable"),c=o.options,m=o.originalSize,a=o.originalPosition;var b={height:(o.size.height-m.height)||0,width:(o.size.width-m.width)||0,top:(o.position.top-a.top)||0,left:(o.position.left-a.left)||0},p=function(h,g){f(h).each(function(){var j=f(this),i=f(this).data("resizable-alsoresize"),k={},r=g&&g.length?g:["width","height","top","left"];f.each(r||["width","height","top","left"],function(v,q){var u=(i[q]||0)+(b[q]||0);if(u&&u>=0){k[q]=u||null}});if(/relative/.test(j.css("position"))&&f.browser.opera){o._revertToRelativePosition=true;j.css({position:"absolute",top:"auto",left:"auto"})}j.css(k)})};if(typeof(c.alsoResize)=="object"&&!c.alsoResize.nodeType){f.each(c.alsoResize,function(h,g){p(h,g)})}else{p(c.alsoResize)}},stop:function(b,a){var c=f(this).data("resizable");if(c._revertToRelativePosition&&f.browser.opera){c._revertToRelativePosition=false;el.css({position:"relative"})}f(this).removeData("resizable-alsoresize-start")}});f.ui.plugin.add("resizable","animate",{stop:function(r,b){var a=f(this).data("resizable"),q=a.options;var s=a._proportionallyResizeElements,v=s.length&&(/textarea/i).test(s[0].nodeName),u=v&&f.ui.hasScroll(s[0],"left")?0:a.sizeDiff.height,o=v?0:a.sizeDiff.width;var t={width:(a.size.width-o),height:(a.size.height-u)},p=(parseInt(a.element.css("left"),10)+(a.position.left-a.originalPosition.left))||null,c=(parseInt(a.element.css("top"),10)+(a.position.top-a.originalPosition.top))||null;a.element.animate(f.extend(t,c&&p?{top:c,left:p}:{}),{duration:q.animateDuration,easing:q.animateEasing,step:function(){var g={width:parseInt(a.element.css("width"),10),height:parseInt(a.element.css("height"),10),top:parseInt(a.element.css("top"),10),left:parseInt(a.element.css("left"),10)};if(s&&s.length){f(s[0]).css({width:g.width,height:g.height})}a._updateCache(g);a._propagate("resize",r)}})}});f.ui.plugin.add("resizable","containment",{start:function(z,b){var B=f(this).data("resizable"),v=B.options,t=B.element;var y=v.containment,u=(y instanceof f)?y.get(0):(/parent/.test(y))?t.parent().get(0):y;if(!u){return}B.containerElement=f(u);if(/document/.test(y)||y==document){B.containerOffset={left:0,top:0};B.containerPosition={left:0,top:0};B.parentData={element:f(document),left:0,top:0,width:f(document).width(),height:f(document).height()||document.body.parentNode.scrollHeight}}else{var o=f(u),w=[];f(["Top","Right","Left","Bottom"]).each(function(g,h){w[g]=d(o.css("padding"+h))});B.containerOffset=o.offset();B.containerPosition=o.position();B.containerSize={height:(o.innerHeight()-w[3]),width:(o.innerWidth()-w[1])};var c=B.containerOffset,A=B.containerSize.height,p=B.containerSize.width,x=(f.ui.hasScroll(u,"left")?u.scrollWidth:p),a=(f.ui.hasScroll(u)?u.scrollHeight:A);B.parentData={element:u,left:c.left,top:c.top,width:x,height:a}}},resize:function(A,c){var D=f(this).data("resizable"),y=D.options,B=D.containerSize,o=D.containerOffset,u=D.size,t=D.position,b=D._aspectRatio||A.shiftKey,C={top:0,left:0},z=D.containerElement;if(z[0]!=document&&(/static/).test(z.css("position"))){C=o}if(t.left<(D._helper?o.left:0)){D.size.width=D.size.width+(D._helper?(D.position.left-o.left):(D.position.left-C.left));if(b){D.size.height=D.size.width/y.aspectRatio}D.position.left=y.helper?o.left:0}if(t.top<(D._helper?o.top:0)){D.size.height=D.size.height+(D._helper?(D.position.top-o.top):D.position.top);if(b){D.size.width=D.size.height*y.aspectRatio}D.position.top=D._helper?o.top:0}D.offset.left=D.parentData.left+D.position.left;D.offset.top=D.parentData.top+D.position.top;var v=Math.abs((D._helper?D.offset.left-C.left:(D.offset.left-C.left))+D.sizeDiff.width),a=Math.abs((D._helper?D.offset.top-C.top:(D.offset.top-o.top))+D.sizeDiff.height);var w=D.containerElement.get(0)==D.element.parent().get(0),x=/relative|absolute/.test(D.containerElement.css("position"));if(w&&x){v-=D.parentData.left}if(v+D.size.width>=D.parentData.width){D.size.width=D.parentData.width-v;if(b){D.size.height=D.size.width/D.aspectRatio}}if(a+D.size.height>=D.parentData.height){D.size.height=D.parentData.height-a;if(b){D.size.width=D.size.height*D.aspectRatio}}},stop:function(w,h){var b=f(this).data("resizable"),v=b.options,r=b.position,o=b.containerOffset,x=b.containerPosition,u=b.containerElement;var t=f(b.helper),a=t.offset(),c=t.outerWidth()-b.sizeDiff.width,s=t.outerHeight()-b.sizeDiff.height;if(b._helper&&!v.animate&&(/relative/).test(u.css("position"))){f(this).css({left:a.left-x.left-o.left,width:c,height:s})}if(b._helper&&!v.animate&&(/static/).test(u.css("position"))){f(this).css({left:a.left-x.left-o.left,width:c,height:s})}}});f.ui.plugin.add("resizable","ghost",{start:function(c,b){var j=f(this).data("resizable"),a=j.options,i=j.size;j.ghost=j.originalElement.clone();j.ghost.css({opacity:0.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof a.ghost=="string"?a.ghost:"");j.ghost.appendTo(j.helper)},resize:function(c,b){var h=f(this).data("resizable"),a=h.options;if(h.ghost){h.ghost.css({position:"relative",height:h.size.height,width:h.size.width})}},stop:function(c,b){var h=f(this).data("resizable"),a=h.options;if(h.ghost&&h.helper){h.helper.get(0).removeChild(h.ghost.get(0))}}});f.ui.plugin.add("resizable","grid",{resize:function(v,c){var a=f(this).data("resizable"),s=a.options,p=a.size,r=a.originalSize,q=a.originalPosition,b=a.axis,o=s._aspectRatio||v.shiftKey;s.grid=typeof s.grid=="number"?[s.grid,s.grid]:s.grid;var t=Math.round((p.width-r.width)/(s.grid[0]||1))*(s.grid[0]||1),u=Math.round((p.height-r.height)/(s.grid[1]||1))*(s.grid[1]||1);if(/^(se|s|e)$/.test(b)){a.size.width=r.width+t;a.size.height=r.height+u}else{if(/^(ne)$/.test(b)){a.size.width=r.width+t;a.size.height=r.height+u;a.position.top=q.top-u}else{if(/^(sw)$/.test(b)){a.size.width=r.width+t;a.size.height=r.height+u;a.position.left=q.left-t}else{a.size.width=r.width+t;a.size.height=r.height+u;a.position.top=q.top-u;a.position.left=q.left-t}}}}});var d=function(a){return parseInt(a,10)||0};var e=function(a){return !isNaN(parseInt(a,10))}})(jQuery);(function(f){var d={dragStart:"start.draggable",drag:"drag.draggable",dragStop:"stop.draggable",maxHeight:"maxHeight.resizable",minHeight:"minHeight.resizable",maxWidth:"maxWidth.resizable",minWidth:"minWidth.resizable",resizeStart:"start.resizable",resize:"drag.resizable",resizeStop:"stop.resizable"},e="ui-dialog ui-widget ui-widget-content ui-corner-all ";f.widget("ui.dialog",{_init:function(){this.originalTitle=this.element.attr("title");var b=this,a=this.options,n=a.title||this.originalTitle||"&nbsp;",s=f.ui.dialog.getTitleId(this.element),c=(this.uiDialog=f("<div/>")).appendTo(document.body).hide().addClass(e+a.dialogClass).css({position:"absolute",overflow:"hidden",zIndex:a.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(g){(a.closeOnEscape&&g.keyCode&&g.keyCode==f.ui.keyCode.ESCAPE&&b.close(g))}).attr({role:"dialog","aria-labelledby":s}).mousedown(function(g){b.moveToTop(false,g)}),q=this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(c),r=(this.uiDialogTitlebar=f("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(c),o=f('<a href="#"/>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){o.addClass("ui-state-hover")},function(){o.removeClass("ui-state-hover")}).focus(function(){o.addClass("ui-state-focus")}).blur(function(){o.removeClass("ui-state-focus")}).mousedown(function(g){g.stopPropagation()}).click(function(g){b.close(g);return false}).appendTo(r),p=(this.uiDialogTitlebarCloseText=f("<span/>")).addClass("ui-icon ui-icon-closethick").text(a.closeText).appendTo(o),t=f("<span/>").addClass("ui-dialog-title").attr("id",s).html(n).prependTo(r);r.find("*").add(r).disableSelection();(a.draggable&&f.fn.draggable&&this._makeDraggable());(a.resizable&&f.fn.resizable&&this._makeResizable());this._createButtons(a.buttons);this._isOpen=false;(a.bgiframe&&f.fn.bgiframe&&c.bgiframe());(a.autoOpen&&this.open())},destroy:function(){(this.overlay&&this.overlay.destroy());this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();(this.originalTitle&&this.element.attr("title",this.originalTitle))},close:function(a){var c=this;if(false===c._trigger("beforeclose",a)){return}(c.overlay&&c.overlay.destroy());c.uiDialog.unbind("keypress.ui-dialog");(c.options.hide?c.uiDialog.hide(c.options.hide,function(){c._trigger("close",a)}):c.uiDialog.hide()&&c._trigger("close",a));f.ui.dialog.overlay.resize();c._isOpen=false;if(c.options.modal){var b=0;f(".ui-dialog").each(function(){if(this!=c.uiDialog[0]){b=Math.max(b,f(this).css("z-index"))}});f.ui.dialog.maxZ=b}},isOpen:function(){return this._isOpen},moveToTop:function(a,b){if((this.options.modal&&!a)||(!this.options.stack&&!this.options.modal)){return this._trigger("focus",b)}if(this.options.zIndex>f.ui.dialog.maxZ){f.ui.dialog.maxZ=this.options.zIndex}(this.overlay&&this.overlay.$el.css("z-index",f.ui.dialog.overlay.maxZ=++f.ui.dialog.maxZ));var c={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};this.uiDialog.css("z-index",++f.ui.dialog.maxZ);this.element.attr(c);this._trigger("focus",b)},open:function(){if(this._isOpen){return}var a=this.options,b=this.uiDialog;this.overlay=a.modal?new f.ui.dialog.overlay(this):null;(b.next().length&&b.appendTo("body"));this._size();this._position(a.position);b.show(a.show);this.moveToTop(true);(a.modal&&b.bind("keypress.ui-dialog",function(j){if(j.keyCode!=f.ui.keyCode.TAB){return}var k=f(":tabbable",this),c=k.filter(":first")[0],l=k.filter(":last")[0];if(j.target==l&&!j.shiftKey){setTimeout(function(){c.focus()},1)}else{if(j.target==c&&j.shiftKey){setTimeout(function(){l.focus()},1)}}}));f([]).add(b.find(".ui-dialog-content :tabbable:first")).add(b.find(".ui-dialog-buttonpane :tabbable:first")).add(b).filter(":first").focus();this._trigger("open");this._isOpen=true},_createButtons:function(a){var b=this,h=false,c=f("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiDialog.find(".ui-dialog-buttonpane").remove();(typeof a=="object"&&a!==null&&f.each(a,function(){return !(h=true)}));if(h){f.each(a,function(j,g){f('<button type="button"></button>').addClass("ui-state-default ui-corner-all").text(j).click(function(){g.apply(b.element[0],arguments)}).hover(function(){f(this).addClass("ui-state-hover")},function(){f(this).removeClass("ui-state-hover")}).focus(function(){f(this).addClass("ui-state-focus")}).blur(function(){f(this).removeClass("ui-state-focus")}).appendTo(c)});c.appendTo(this.uiDialog)}},_makeDraggable:function(){var c=this,a=this.options,b;this.uiDialog.draggable({cancel:".ui-dialog-content",handle:".ui-dialog-titlebar",containment:"document",start:function(){b=a.height;f(this).height(f(this).height()).addClass("ui-dialog-dragging");(a.dragStart&&a.dragStart.apply(c.element[0],arguments))},drag:function(){(a.drag&&a.drag.apply(c.element[0],arguments))},stop:function(){f(this).removeClass("ui-dialog-dragging").height(b);(a.dragStop&&a.dragStop.apply(c.element[0],arguments));f.ui.dialog.overlay.resize()}})},_makeResizable:function(a){a=(a===undefined?this.options.resizable:a);var h=this,b=this.options,c=typeof a=="string"?a:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",alsoResize:this.element,maxWidth:b.maxWidth,maxHeight:b.maxHeight,minWidth:b.minWidth,minHeight:b.minHeight,start:function(){f(this).addClass("ui-dialog-resizing");(b.resizeStart&&b.resizeStart.apply(h.element[0],arguments))},resize:function(){(b.resize&&b.resize.apply(h.element[0],arguments))},handles:c,stop:function(){f(this).removeClass("ui-dialog-resizing");b.height=f(this).height();b.width=f(this).width();(b.resizeStop&&b.resizeStop.apply(h.element[0],arguments));f.ui.dialog.overlay.resize()}}).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_position:function(a){var k=f(window),j=f(document),c=j.scrollTop(),l=j.scrollLeft(),b=c;if(f.inArray(a,["center","top","right","bottom","left"])>=0){a=[a=="right"||a=="left"?a:"center",a=="top"||a=="bottom"?a:"middle"]}if(a.constructor!=Array){a=["center","middle"]}if(a[0].constructor==Number){l+=a[0]}else{switch(a[0]){case"left":l+=0;break;case"right":l+=k.width()-this.uiDialog.outerWidth();break;default:case"center":l+=(k.width()-this.uiDialog.outerWidth())/2}}if(a[1].constructor==Number){c+=a[1]}else{switch(a[1]){case"top":c+=0;break;case"bottom":c+=k.height()-this.uiDialog.outerHeight();break;default:case"middle":c+=(k.height()-this.uiDialog.outerHeight())/2}}c=Math.max(c,b);this.uiDialog.css({top:c,left:l})},_setData:function(c,b){(d[c]&&this.uiDialog.data(d[c],b));switch(c){case"buttons":this._createButtons(b);break;case"closeText":this.uiDialogTitlebarCloseText.text(b);break;case"dialogClass":this.uiDialog.removeClass(this.options.dialogClass).addClass(e+b);break;case"draggable":(b?this._makeDraggable():this.uiDialog.draggable("destroy"));break;case"height":this.uiDialog.height(b);break;case"position":this._position(b);break;case"resizable":var h=this.uiDialog,a=this.uiDialog.is(":data(resizable)");(a&&!b&&h.resizable("destroy"));(a&&typeof b=="string"&&h.resizable("option","handles",b));(a||this._makeResizable(b));break;case"title":f(".ui-dialog-title",this.uiDialogTitlebar).html(b||"&nbsp;");break;case"width":this.uiDialog.width(b);break}f.widget.prototype._setData.apply(this,arguments)},_size:function(){var a=this.options;this.element.css({height:0,minHeight:0,width:"auto"});var b=this.uiDialog.css({height:"auto",width:a.width}).height();this.element.css({minHeight:Math.max(a.minHeight-b,0),height:a.height=="auto"?"auto":Math.max(a.height-b,0)})}});f.extend(f.ui.dialog,{version:"1.7.2",defaults:{autoOpen:true,bgiframe:false,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:"center",resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},getter:"isOpen",uuid:0,maxZ:0,getTitleId:function(a){return"ui-dialog-title-"+(a.attr("id")||++this.uuid)},overlay:function(a){this.$el=f.ui.dialog.overlay.create(a)}});f.extend(f.ui.dialog.overlay,{instances:[],maxZ:0,events:f.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(a){if(this.instances.length===0){setTimeout(function(){if(f.ui.dialog.overlay.instances.length){f(document).bind(f.ui.dialog.overlay.events,function(h){var c=f(h.target).parents(".ui-dialog").css("zIndex")||0;return(c>f.ui.dialog.overlay.maxZ)})}},1);f(document).bind("keydown.dialog-overlay",function(c){(a.options.closeOnEscape&&c.keyCode&&c.keyCode==f.ui.keyCode.ESCAPE&&a.close(c))});f(window).bind("resize.dialog-overlay",f.ui.dialog.overlay.resize)}var b=f("<div></div>").appendTo(document.body).addClass("ui-widget-overlay").css({width:this.width(),height:this.height()});(a.options.bgiframe&&f.fn.bgiframe&&b.bgiframe());this.instances.push(b);return b},destroy:function(b){this.instances.splice(f.inArray(this.instances,b),1);if(this.instances.length===0){f([document,window]).unbind(".dialog-overlay")}b.remove();var a=0;f.each(this.instances,function(){a=Math.max(a,this.css("z-index"))});this.maxZ=a},height:function(){if(f.browser.msie&&f.browser.version<7){var a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);var b=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(a<b){return f(window).height()+"px"}else{return a+"px"}}else{return f(document).height()+"px"}},width:function(){if(f.browser.msie&&f.browser.version<7){var b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);var a=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(b<a){return f(window).width()+"px"}else{return b+"px"}}else{return f(document).width()+"px"}},resize:function(){var a=f([]);f.each(f.ui.dialog.overlay.instances,function(){a=a.add(this)});a.css({width:0,height:0}).css({width:f.ui.dialog.overlay.width(),height:f.ui.dialog.overlay.height()})}});f.extend(f.ui.dialog.overlay.prototype,{destroy:function(){f.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
//easing
jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing[jQuery.easing.def](e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return -h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f+a}return -h/2*((--f)*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f+a}return h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return -h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f+a}return -h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return -h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return -h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return(f==0)?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return(f==g)?a+h:h*(-Math.pow(2,-10*f/g)+1)+a},easeInOutExpo:function(e,f,a,h,g){if(f==0){return a}if(f==g){return a+h}if((f/=g/2)<1){return h/2*Math.pow(2,10*(f-1))+a}return h/2*(-Math.pow(2,-10*--f)+2)+a},easeInCirc:function(e,f,a,h,g){return -h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){if((f/=g/2)<1){return -h/2*(Math.sqrt(1-f*f)-1)+a}return h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e},easeOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+l+e},easeInOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k/2)==2){return e+l}if(!j){j=k*(0.3*1.5)}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*0.5+l+e},easeInBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return i/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return i/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){if((f/=g)<(1/2.75)){return h*(7.5625*f*f)+a}else{if(f<(2/2.75)){return h*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return h*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return h*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},easeInOutBounce:function(e,f,a,h,g){if(f<g/2){return jQuery.easing.easeInBounce(e,f*2,0,h,g)*0.5+a}return jQuery.easing.easeOutBounce(e,f*2-g,0,h,g)*0.5+h*0.5+a}});
//expander
//(function(a){a.fn.TextAreaExpander=function(e,d){var c=!(a.browser.msie||a.browser.opera);function b(i){i=i.target||i;var j=i.value.length,g=i.offsetWidth;if(j!=i.valLength||g!=i.boxWidth){if(c&&(j<i.valLength||g!=i.boxWidth)){i.style.height="0px"}var f=Math.max(i.expandMin,Math.min(i.scrollHeight,i.expandMax));i.style.overflow=(i.scrollHeight>f?"auto":"hidden");i.style.height=f+"px";i.valLength=j;i.boxWidth=g}return true}this.each(function(){if(this.nodeName.toLowerCase()!="textarea"){return}var f=this.className.match(/expand(\d+)\-*(\d+)*/i);this.expandMin=e||(f?parseInt("0"+f[1],10):0);this.expandMax=d||(f?parseInt("0"+f[2],10):99999);b(this);if(!this.Initialized){this.Initialized=true;a(this).css("padding-top",0).css("padding-bottom",0);a(this).bind("keyup",b).bind("focus",b)}});return this}})(jQuery);
//date picker
(function(b){var a=function(){var c={},n={years:"datepickerViewYears",moths:"datepickerViewMonths",days:"datepickerViewDays"},k={wrapper:'<div class="datepicker png"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table><tbody><tr></tr></tbody></table></div></div>',head:["<td>","<table>","<thead>","<tr>",'<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="6" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">','<th class="wkhd"><span><%=week%></span></th>',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"],space:'<td class="datepickerSpace"><div></div></td>',days:['<tbody class="datepickerDays">',"<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[0].week%></span></a></th>','<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[1].week%></span></a></th>','<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[2].week%></span></a></th>','<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[3].week%></span></a></th>','<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[4].week%></span></a></th>','<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>',"</tr>","<tr>",'<th class="datepickerWeek"><a href="#"><span><%=weeks[5].week%></span></a></th>','<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"],months:['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>","</tbody>"]},g={flat:false,starts:1,prev:"&larr;",next:"&rarr;",lastSel:false,mode:"single",view:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",onRender:function(){return{}},onChange:function(){return true},onShow:function(){return true},onBeforeShow:function(){return true},onHide:function(){return true},locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб","Вс"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],weekMin:"нд"}},p=function(r){var u=b(r).data("datepicker");var y=b(r);var s=Math.floor(u.calendars/2),G,I,z,H,E=0,C,v,t,w,x,A;y.find("td>table tbody").remove();for(var F=0;F<u.calendars;F++){G=new Date(u.current);G.addMonths(-s+F);A=y.find("table").eq(F+1);switch(A[0].className){case"datepickerViewDays":z=q(G,"B, Y");break;case"datepickerViewMonths":z=G.getFullYear();break;case"datepickerViewYears":z=(G.getFullYear()-6)+" - "+(G.getFullYear()+5);break}A.find("thead tr:first th:eq(1) span").text(z);z=G.getFullYear()-6;I={data:[],className:"datepickerYears"};for(var D=0;D<12;D++){I.data.push(z+D)}x=tmpl(k.months.join(""),I);G.setDate(1);I={weeks:[],test:10};H=G.getMonth();var z=(G.getDay()-u.starts)%7;G.addDays(-(z+(z<0?7:0)));C=-1;E=0;while(E<42){t=parseInt(E/7,10);w=E%7;if(!I.weeks[t]){C=G.getWeekNumber();I.weeks[t]={week:C,days:[]}}I.weeks[t].days[w]={text:G.getDate(),classname:[]};if(H!=G.getMonth()){I.weeks[t].days[w].classname.push("datepickerNotInMonth")}if(G.getDay()==0){I.weeks[t].days[w].classname.push("datepickerSunday")}if(G.getDay()==6){I.weeks[t].days[w].classname.push("datepickerSaturday")}var B=u.onRender(G);var J=G.valueOf();if(B.selected||u.date==J||b.inArray(J,u.date)>-1||(u.mode=="range"&&J>=u.date[0]&&J<=u.date[1])){I.weeks[t].days[w].classname.push("datepickerSelected")}if(B.disabled){I.weeks[t].days[w].classname.push("datepickerDisabled")}if(B.className){I.weeks[t].days[w].classname.push(B.className)}I.weeks[t].days[w].classname=I.weeks[t].days[w].classname.join(" ");E++;G.addDays(1)}x=tmpl(k.days.join(""),I)+x;I={data:u.locale.monthsShort,className:"datepickerMonths"};x=tmpl(k.months.join(""),I)+x;A.append(x)}},e=function(s,C){if(s.constructor==Date){return new Date(s)}var w=s.split(/\W+/);var t=C.split(/\W+/),A,u,B,z,v,r=new Date();for(var x=0;x<w.length;x++){switch(t[x]){case"d":case"e":A=parseInt(w[x],10);break;case"m":u=parseInt(w[x],10)-1;break;case"Y":case"y":B=parseInt(w[x],10);B+=B>100?0:(B<29?2000:1900);break;case"H":case"I":case"k":case"l":z=parseInt(w[x],10);break;case"P":case"p":if(/pm/i.test(w[x])&&z<12){z+=12}else{if(/am/i.test(w[x])&&z>=12){z-=12}}break;case"M":v=parseInt(w[x],10);break}}return new Date(B===undefined?r.getFullYear():B,u===undefined?r.getMonth():u,A===undefined?r.getDate():A,z===undefined?r.getHours():z,v===undefined?r.getMinutes():v,0)},q=function(t,F){var u=t.getMonth();var D=t.getDate();var E=t.getFullYear();var G=t.getWeekNumber();var H=t.getDay();var K={};var I=t.getHours();var v=(I>=12);var B=(v)?(I-12):I;var J=t.getDayOfYear();if(B==0){B=12}var z=t.getMinutes();var C=t.getSeconds();var x=F.split(""),r;for(var A=0;A<x.length;A++){r=x[A];switch(x[A]){case"a":r=t.getDayName();break;case"A":r=t.getDayName(true);break;case"b":r=t.getMonthName();break;case"B":r=t.getMonthName(true);break;case"C":r=1+Math.floor(E/100);break;case"d":r=(D<10)?("0"+D):D;break;case"e":r=D;break;case"H":r=(I<10)?("0"+I):I;break;case"I":r=(B<10)?("0"+B):B;break;case"j":r=(J<100)?((J<10)?("00"+J):("0"+J)):J;break;case"k":r=I;break;case"l":r=B;break;case"m":r=(u<9)?("0"+(1+u)):(1+u);break;case"M":r=(z<10)?("0"+z):z;break;case"p":case"P":r=v?"PM":"AM";break;case"s":r=Math.floor(t.getTime()/1000);break;case"S":r=(C<10)?("0"+C):C;break;case"u":r=H+1;break;case"w":r=H;break;case"y":r=(""+E).substr(2,2);break;case"Y":r=E;break}x[A]=r}return x.join("")},f=function(r){if(Date.prototype.tempDate){return}Date.prototype.tempDate=null;Date.prototype.months=r.months;Date.prototype.monthsShort=r.monthsShort;Date.prototype.days=r.days;Date.prototype.daysShort=r.daysShort;Date.prototype.getMonthName=function(s){return this[s?"months":"monthsShort"][this.getMonth()]};Date.prototype.getDayName=function(s){return this[s?"days":"daysShort"][this.getDay()]};Date.prototype.addDays=function(s){this.setDate(this.getDate()+s);this.tempDate=this.getDate()};Date.prototype.addMonths=function(s){if(this.tempDate==null){this.tempDate=this.getDate()}this.setDate(1);this.setMonth(this.getMonth()+s);this.setDate(Math.min(this.tempDate,this.getMaxDays()))};Date.prototype.addYears=function(s){if(this.tempDate==null){this.tempDate=this.getDate()}this.setDate(1);this.setFullYear(this.getFullYear()+s);this.setDate(Math.min(this.tempDate,this.getMaxDays()))};Date.prototype.getMaxDays=function(){var t=new Date(Date.parse(this)),u=28,s;s=t.getMonth();u=28;while(t.getMonth()==s){u++;t.setDate(u)}return u-1};Date.prototype.getFirstDay=function(){var s=new Date(Date.parse(this));s.setDate(1);return s.getDay()};Date.prototype.getWeekNumber=function(){var s=new Date(this);s.setDate(s.getDate()-(s.getDay()+6)%7+3);var t=s.valueOf();s.setMonth(0);s.setDate(4);return Math.round((t-s.valueOf())/(604800000))+1};Date.prototype.getDayOfYear=function(){var s=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var u=new Date(this.getFullYear(),0,0,0,0,0);var t=s-u;return Math.floor(t/24*60*60*1000)}},i=function(v){var s=b(v).data("datepicker");var x=b("#"+s.id);if(!s.extraHeight){var u=b(v).find("div");s.extraHeight=u.get(0).offsetHeight+u.get(1).offsetHeight;s.extraWidth=u.get(2).offsetWidth+u.get(3).offsetWidth}var w=x.find("table:first").get(0);var t=w.offsetWidth;var r=w.offsetHeight;x.css({width:t+s.extraWidth+"px",height:r+s.extraHeight+"px"}).find("div.datepickerContainer").css({width:t+"px",height:r+"px"})},o=function(y){if(b(y.target).is("span")){y.target=y.target.parentNode}var t=b(y.target);if(t.is("a")){y.target.blur();if(t.hasClass("datepickerDisabled")){return false}var A=b(this).data("datepicker");var x=t.parent();var s=x.parent().parent().parent();var z=b("table",this).index(s.get(0))-1;var w=new Date(A.current);var v=false;var r=false;if(x.is("th")){if(x.hasClass("datepickerWeek")&&A.mode=="range"&&!x.next().hasClass("datepickerDisabled")){var u=parseInt(x.next().text(),10);w.addMonths(z-Math.floor(A.calendars/2));if(x.next().hasClass("datepickerNotInMonth")){w.addMonths(u>15?-1:1)}w.setDate(u);A.date[0]=(w.setHours(0,0,0,0)).valueOf();w.setHours(23,59,59,0);w.addDays(6);A.date[1]=w.valueOf();r=true;v=true;A.lastSel=false}else{if(x.hasClass("datepickerMonth")){w.addMonths(z-Math.floor(A.calendars/2));switch(s.get(0).className){case"datepickerViewDays":s.get(0).className="datepickerViewMonths";t.find("span").text(w.getFullYear());break;case"datepickerViewMonths":s.get(0).className="datepickerViewYears";t.find("span").text((w.getFullYear()-6)+" - "+(w.getFullYear()+5));break;case"datepickerViewYears":s.get(0).className="datepickerViewDays";t.find("span").text(q(w,"B, Y"));break}}else{if(x.parent().parent().is("thead")){switch(s.get(0).className){case"datepickerViewDays":A.current.addMonths(x.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewMonths":A.current.addYears(x.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewYears":A.current.addYears(x.hasClass("datepickerGoPrev")?-12:12);break}r=true}}}}else{if(x.is("td")&&!x.hasClass("datepickerDisabled")){switch(s.get(0).className){case"datepickerViewMonths":A.current.setMonth(s.find("tbody.datepickerMonths td").index(x));A.current.setFullYear(parseInt(s.find("thead th.datepickerMonth span").text(),10));A.current.addMonths(Math.floor(A.calendars/2)-z);s.get(0).className="datepickerViewDays";break;case"datepickerViewYears":A.current.setFullYear(parseInt(t.text(),10));s.get(0).className="datepickerViewMonths";break;default:var u=parseInt(t.text(),10);w.addMonths(z-Math.floor(A.calendars/2));if(x.hasClass("datepickerNotInMonth")){w.addMonths(u>15?-1:1)}w.setDate(u);switch(A.mode){case"multiple":u=(w.setHours(0,0,0,0)).valueOf();if(b.inArray(u,A.date)>-1){b.each(A.date,function(B,C){if(C==u){A.date.splice(B,1);return false}})}else{A.date.push(u)}break;case"range":if(!A.lastSel){A.date[0]=(w.setHours(0,0,0,0)).valueOf()}u=(w.setHours(23,59,59,0)).valueOf();if(u<A.date[0]){A.date[1]=A.date[0]+86399000;A.date[0]=u-86399000}else{A.date[1]=u}A.lastSel=!A.lastSel;break;default:A.date=w.valueOf();break}break}r=true;v=true}}if(r){p(this)}if(v){A.onChange.apply(this,j(A))}}return false},j=function(r){var s;if(r.mode=="single"){s=new Date(r.date);return[q(s,r.format),s,r.el]}else{s=[[],[],r.el];b.each(r.date,function(u,v){var t=new Date(v);s[0].push(q(t,r.format));s[1].push(t)});return s}},d=function(){var r=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(r?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(r?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(r?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(r?document.documentElement.clientHeight:document.body.clientHeight)}},l=function(t,s,r){if(t==s){return true}if(t.contains){return t.contains(s)}if(t.compareDocumentPosition){return !!(t.compareDocumentPosition(s)&16)}var u=s.parentNode;while(u&&u!=r){if(u==t){return true}u=u.parentNode}return false},m=function(w){var r=b("#"+b(this).data("datepickerId"));if(!r.is(":visible")){var x=r.get(0);p(x);var z=r.data("datepicker");z.onBeforeShow.apply(this,[r.get(0)]);var u=b(this).offset();var y=d();var v=u.top;var s=u.left;var t=b.curCSS(x,"display");r.css({visibility:"hidden",display:"block"});i(x);switch(z.position){case"top":v-=x.offsetHeight;break;case"left":s-=x.offsetWidth;break;case"right":s+=this.offsetWidth;break;case"bottom":v+=this.offsetHeight;break}if(v+x.offsetHeight>y.t+y.h){v=u.top-x.offsetHeight}if(v<y.t){v=u.top+this.offsetHeight+x.offsetHeight}if(s+x.offsetWidth>y.l+y.w){s=u.left-x.offsetWidth}if(s<y.l){s=u.left+this.offsetWidth}r.css({top:v+"px",left:s+"px",visibility:"visible",display:"block"});if(z.onShow.apply(this,[r.get(0)])!=false){r.show()}b(document).bind("mousedown",{cal:r,trigger:this},h)}return false},h=function(r){if(r.target!=r.data.trigger&&!l(r.data.cal.get(0),r.target,r.data.cal.get(0))){if(r.data.cal.data("datepicker").onHide.apply(this,[r.data.cal.get(0)])!=false){r.data.cal.hide()}b(document).unbind("mousedown",h)}};return{init:function(r){r=b.extend({},g,r||{});f(r.locale);r.calendars=Math.max(1,parseInt(r.calendars,10)||1);r.mode=/single|multiple|range/.test(r.mode)?r.mode:"single";return this.each(function(){if(!b(this).data("datepicker")){r.el=this;if(r.date.constructor==String){r.date=e(r.date,r.format);r.date.setHours(0,0,0,0)}if(r.mode!="single"){if(r.date.constructor!=Array){r.date=[r.date.valueOf()];if(r.mode=="range"){r.date.push(((new Date(r.date[0])).setHours(23,59,59,0)).valueOf())}}else{for(var u=0;u<r.date.length;u++){r.date[u]=(e(r.date[u],r.format).setHours(0,0,0,0)).valueOf()}if(r.mode=="range"){r.date[1]=((new Date(r.date[1])).setHours(23,59,59,0)).valueOf()}}}else{r.date=r.date.valueOf()}if(!r.current){r.current=new Date()}else{r.current=e(r.current,r.format)}r.current.setDate(1);r.current.setHours(0,0,0,0);var w="datepicker_"+parseInt(Math.random()*1000),t;r.id=w;b(this).data("datepickerId",r.id);var v=b(k.wrapper).attr("id",w).bind("click",o).data("datepicker",r);if(r.className){v.addClass(r.className)}var s="";for(var u=0;u<r.calendars;u++){t=r.starts;if(u>0){s+=k.space}s+=tmpl(k.head.join(""),{week:r.locale.weekMin,prev:r.prev,next:r.next,day1:r.locale.daysMin[(t++)%7],day2:r.locale.daysMin[(t++)%7],day3:r.locale.daysMin[(t++)%7],day4:r.locale.daysMin[(t++)%7],day5:r.locale.daysMin[(t++)%7],day6:r.locale.daysMin[(t++)%7],day7:r.locale.daysMin[(t++)%7]})}v.find("tr:first").append(s).find("table").addClass(n[r.view]);p(v.get(0));if(r.flat){v.appendTo(this).show().css("position","relative");i(v.get(0))}else{v.appendTo(document.body);b(this).bind(r.eventName,m)}}})},showPicker:function(){return this.each(function(){if(b(this).data("datepickerId")){m.apply(this)}})},hidePicker:function(){return this.each(function(){if(b(this).data("datepickerId")){b("#"+b(this).data("datepickerId")).hide()}})},setDate:function(r,s){return this.each(function(){if(b(this).data("datepickerId")){var v=b("#"+b(this).data("datepickerId"));var t=v.data("datepicker");t.date=r;if(t.date.constructor==String){t.date=e(t.date,t.format);t.date.setHours(0,0,0,0)}if(t.mode!="single"){if(t.date.constructor!=Array){t.date=[t.date.valueOf()];if(t.mode=="range"){t.date.push(((new Date(t.date[0])).setHours(23,59,59,0)).valueOf())}}else{for(var u=0;u<t.date.length;u++){t.date[u]=(e(t.date[u],t.format).setHours(0,0,0,0)).valueOf()}if(t.mode=="range"){t.date[1]=((new Date(t.date[1])).setHours(23,59,59,0)).valueOf()}}}else{t.date=t.date.valueOf()}if(s){t.current=new Date(t.mode!="single"?t.date[0]:t.date)}p(v.get(0))}})},getDate:function(r){if(this.size()>0){return j(b("#"+b(this).data("datepickerId")).data("datepicker"))[r?0:1]}},clear:function(){return this.each(function(){if(b(this).data("datepickerId")){var s=b("#"+b(this).data("datepickerId"));var r=s.data("datepicker");if(r.mode!="single"){r.date=[];p(s.get(0))}}})},fixLayout:function(){return this.each(function(){if(b(this).data("datepickerId")){var s=b("#"+b(this).data("datepickerId"));var r=s.data("datepicker");if(r.flat){i(s.get(0))}}})}}}();b.fn.extend({DatePicker:a.init,DatePickerHide:a.hidePicker,DatePickerShow:a.showPicker,DatePickerSetDate:a.setDate,DatePickerGetDate:a.getDate,DatePickerClear:a.clear,DatePickerLayout:a.fixLayout})})(jQuery);(function(){var b={};this.tmpl=function a(e,d){var c=!/\W/.test(e)?b[e]=b[e]||a(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return d?c(d):c}})();
//fancybox
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}(';(7($){$.b.2Q=7(){u B.2t(7(){9 1J=$(B).n(\'2Z\');5(1J.1c(/^3w\\(["\']?(.*\\.2p)["\']?\\)$/i)){1J=3t.$1;$(B).n({\'2Z\':\'45\',\'2o\':"3W:3R.4m.4d(3h=F, 3T="+($(B).n(\'41\')==\'2J-3Z\'?\'4c\':\'3N\')+", Q=\'"+1J+"\')"}).2t(7(){9 1b=$(B).n(\'1b\');5(1b!=\'2e\'&&1b!=\'2n\')$(B).n(\'1b\',\'2n\')})}})};9 A,4,16=D,s=1t 1o,1w,1v=1,1y=/\\.(3A|3Y|2p|3c|3d)(.*)?$/i;9 P=($.2q.3K&&2f($.2q.3z.2k(0,1))<8);$.b.c=7(Y){Y=$.3x({},$.b.c.2R,Y);9 2s=B;7 2h(){A=B;4=Y;2r();u D};7 2r(){5(16)u;5($.1O(4.2c)){4.2c()}4.j=[];4.h=0;5(Y.j.N>0){4.j=Y.j}t{9 O={};5(!A.1H||A.1H==\'\'){9 O={d:A.d,X:A.X};5($(A).1G("1m:1D").N){O.1a=$(A).1G("1m:1D")}4.j.2j(O)}t{9 Z=$(2s).2o("a[1H="+A.1H+"]");9 O={};3C(9 i=0;i<Z.N;i++){O={d:Z[i].d,X:Z[i].X};5($(Z[i]).1G("1m:1D").N){O.1a=$(Z[i]).1G("1m:1D")}4.j.2j(O)}3F(4.j[4.h].d!=A.d){4.h++}}}5(4.23){5(P){$(\'1U, 1Q, 1P\').n(\'1S\',\'3s\')}$("#1i").n(\'25\',4.2U).J()}1d()};7 1d(){$("#1f, #1e, #V, #G").S();9 d=4.j[4.h].d;5(d.1c(/#/)){9 U=11.3r.d.3f(\'#\')[0];U=d.3g(U,\'\');U=U.2k(U.2l(\'#\'));1k(\'<6 l="3e">\'+$(U).o()+\'</6>\',4.1I,4.1x)}t 5(d.1c(1y)){s=1t 1o;s.Q=d;5(s.3a){1K()}t{$.b.c.34();$(s).x().14(\'3b\',7(){$(".I").S();1K()})}}t 5(d.1c("17")||A.3j.2l("17")>=0){1k(\'<17 l="35" 3q="$.b.c.38()" 3o="3n\'+C.T(C.3l()*3m)+\'" 2K="0" 3E="0" Q="\'+d+\'"></17>\',4.1I,4.1x)}t{$.4p(d,7(2m){1k(\'<6 l="3L">\'+2m+\'</6>\',4.1I,4.1x)})}};7 1K(){5(4.30){9 w=$.b.c.1n();9 r=C.1M(C.1M(w[0]-36,s.g)/s.g,C.1M(w[1]-4b,s.f)/s.f);9 g=C.T(r*s.g);9 f=C.T(r*s.f)}t{9 g=s.g;9 f=s.f}1k(\'<1m 48="" l="49" Q="\'+s.Q+\'" />\',g,f)};7 2F(){5((4.j.N-1)>4.h){9 d=4.j[4.h+1].d;5(d.1c(1y)){1A=1t 1o();1A.Q=d}}5(4.h>0){9 d=4.j[4.h-1].d;5(d.1c(1y)){1A=1t 1o();1A.Q=d}}};7 1k(1j,g,f){16=F;9 L=4.2Y;5(P){$("#q")[0].1E.2u("f");$("#q")[0].1E.2u("g")}5(L>0){g+=L*2;f+=L*2;$("#q").n({\'v\':L+\'z\',\'2E\':L+\'z\',\'2i\':L+\'z\',\'y\':L+\'z\',\'g\':\'2B\',\'f\':\'2B\'});5(P){$("#q")[0].1E.2C(\'f\',\'(B.2D.4j - 20)\');$("#q")[0].1E.2C(\'g\',\'(B.2D.3S - 20)\')}}t{$("#q").n({\'v\':0,\'2E\':0,\'2i\':0,\'y\':0,\'g\':\'2z%\',\'f\':\'2z%\'})}5($("#k").1u(":19")&&g==$("#k").g()&&f==$("#k").f()){$("#q").1Z("2N",7(){$("#q").1C().1F($(1j)).21("1s",7(){1g()})});u}9 w=$.b.c.1n();9 2v=(g+36)>w[0]?w[2]:(w[2]+C.T((w[0]-g-36)/2));9 2w=(f+1z)>w[1]?w[3]:(w[3]+C.T((w[1]-f-1z)/2));9 K={\'y\':2v,\'v\':2w,\'g\':g+\'z\',\'f\':f+\'z\'};5($("#k").1u(":19")){$("#q").1Z("1s",7(){$("#q").1C();$("#k").24(K,4.2X,4.2T,7(){$("#q").1F($(1j)).21("1s",7(){1g()})})})}t{5(4.1W>0&&4.j[4.h].1a!==1L){$("#q").1C().1F($(1j));9 M=4.j[4.h].1a;9 15=$.b.c.1R(M);$("#k").n({\'y\':(15.y-18)+\'z\',\'v\':(15.v-18)+\'z\',\'g\':$(M).g(),\'f\':$(M).f()});5(4.1X){K.25=\'J\'}$("#k").24(K,4.1W,4.2W,7(){1g()})}t{$("#q").S().1C().1F($(1j)).J();$("#k").n(K).21("1s",7(){1g()})}}};7 2y(){5(4.h!=0){$("#1e, #2O").x().14("R",7(e){e.2x();4.h--;1d();u D});$("#1e").J()}5(4.h!=(4.j.N-1)){$("#1f, #2M").x().14("R",7(e){e.2x();4.h++;1d();u D});$("#1f").J()}};7 1g(){2y();2F();$(W).1B(7(e){5(e.29==27){$.b.c.1l();$(W).x("1B")}t 5(e.29==37&&4.h!=0){4.h--;1d();$(W).x("1B")}t 5(e.29==39&&4.h!=(4.j.N-1)){4.h++;1d();$(W).x("1B")}});5(4.1r){$(11).14("1N 1T",$.b.c.2g)}t{$("6#k").n("1b","2e")}5(4.2b){$("#22").R($.b.c.1l)}$("#1i, #V").14("R",$.b.c.1l);$("#V").J();5(4.j[4.h].X!==1L&&4.j[4.h].X.N>0){$(\'#G 6\').o(4.j[4.h].X);$(\'#G\').J()}5(4.23&&P){$(\'1U, 1Q, 1P\',$(\'#q\')).n(\'1S\',\'19\')}5($.1O(4.2a)){4.2a()}16=D};u B.x(\'R\').R(2h)};$.b.c.2g=7(){9 m=$.b.c.1n();$("#k").n(\'y\',(($("#k").g()+36)>m[0]?m[2]:m[2]+C.T((m[0]-$("#k").g()-36)/2)));$("#k").n(\'v\',(($("#k").f()+1z)>m[1]?m[3]:m[3]+C.T((m[1]-$("#k").f()-1z)/2)))};$.b.c.1h=7(H,2A){u 2f($.3I(H.3u?H[0]:H,2A,F))||0};$.b.c.1R=7(H){9 m=H.4g();m.v+=$.b.c.1h(H,\'3k\');m.v+=$.b.c.1h(H,\'3J\');m.y+=$.b.c.1h(H,\'3H\');m.y+=$.b.c.1h(H,\'3D\');u m};$.b.c.38=7(){$(".I").S();$("#35").J()};$.b.c.1n=7(){u[$(11).g(),$(11).f(),$(W).3i(),$(W).3p()]};$.b.c.2G=7(){5(!$("#I").1u(\':19\')){33(1w);u}$("#I > 6").n(\'v\',(1v*-40)+\'z\');1v=(1v+1)%12};$.b.c.34=7(){33(1w);9 m=$.b.c.1n();$("#I").n({\'y\':((m[0]-40)/2+m[2]),\'v\':((m[1]-40)/2+m[3])}).J();$("#I").14(\'R\',$.b.c.1l);1w=3Q($.b.c.2G,3X)};$.b.c.1l=7(){16=F;$(s).x();$("#1i, #V").x();5(4.2b){$("#22").x()}$("#V, .I, #1e, #1f, #G").S();5(4.1r){$(11).x("1N 1T")}1q=7(){$("#1i, #k").S();5(4.1r){$(11).x("1N 1T")}5(P){$(\'1U, 1Q, 1P\').n(\'1S\',\'19\')}5($.1O(4.1V)){4.1V()}16=D};5($("#k").1u(":19")!==D){5(4.26>0&&4.j[4.h].1a!==1L){9 M=4.j[4.h].1a;9 15=$.b.c.1R(M);9 K={\'y\':(15.y-18)+\'z\',\'v\':(15.v-18)+\'z\',\'g\':$(M).g(),\'f\':$(M).f()};5(4.1X){K.25=\'S\'}$("#k").31(D,F).24(K,4.26,4.2S,1q)}t{$("#k").31(D,F).1Z("2N",1q)}}t{1q()}u D};$.b.c.2V=7(){9 o=\'\';o+=\'<6 l="1i"></6>\';o+=\'<6 l="22">\';o+=\'<6 p="I" l="I"><6></6></6>\';o+=\'<6 l="k">\';o+=\'<6 l="2I">\';o+=\'<6 l="V"></6>\';o+=\'<6 l="E"><6 p="E 44"></6><6 p="E 43"></6><6 p="E 42"></6><6 p="E 3V"></6><6 p="E 3U"></6><6 p="E 3O"></6><6 p="E 3M"></6><6 p="E 3P"></6></6>\';o+=\'<a d="2P:;" l="1e"><1p p="1Y" l="2O"></1p></a><a d="2P:;" l="1f"><1p p="1Y" l="2M"></1p></a>\';o+=\'<6 l="q"></6>\';o+=\'<6 l="G"></6>\';o+=\'</6>\';o+=\'</6>\';o+=\'</6>\';$(o).2H("46");$(\'<32 4i="0" 4h="0" 4k="0"><2L><13 p="G" l="4l"></13><13 p="G" l="4o"><6></6></13><13 p="G" l="4n"></13></2L></32>\').2H(\'#G\');5(P){$("#2I").47(\'<17 p="4a" 4e="2J" 2K="0"></17>\');$("#V, .E, .G, .1Y").2Q()}};$.b.c.2R={2Y:10,30:F,1X:D,1W:0,26:0,2X:3G,2W:\'28\',2S:\'28\',2T:\'28\',1I:3B,1x:3v,23:F,2U:0.3,2b:F,1r:F,j:[],2c:2d,2a:2d,1V:2d};$(W).3y(7(){$.b.c.2V()})})(4f);',62,274,'||||opts|if|div|function||var||fn|fancybox|href||height|width|itemCurrent||itemArray|fancy_outer|id|pos|css|html|class|fancy_content||imagePreloader|else|return|top||unbind|left|px|elem|this|Math|false|fancy_bg|true|fancy_title|el|fancy_loading|show|itemOpts|pad|orig_item|length|item|isIE|src|click|hide|round|target|fancy_close|document|title|settings|subGroup||window||td|bind|orig_pos|busy|iframe||visible|orig|position|match|_change_item|fancy_left|fancy_right|_finish|getNumeric|fancy_overlay|value|_set_content|close|img|getViewport|Image|span|__cleanup|centerOnScroll|normal|new|is|loadingFrame|loadingTimer|frameHeight|imageRegExp|50|objNext|keydown|empty|first|style|append|children|rel|frameWidth|image|_proceed_image|undefined|min|resize|isFunction|select|object|getPosition|visibility|scroll|embed|callbackOnClose|zoomSpeedIn|zoomOpacity|fancy_ico|fadeOut||fadeIn|fancy_wrap|overlayShow|animate|opacity|zoomSpeedOut||swing|keyCode|callbackOnShow|hideOnContentClick|callbackOnStart|null|absolute|parseInt|scrollBox|_initialize|bottom|push|substr|indexOf|data|relative|filter|png|browser|_start|matchedGroup|each|removeExpression|itemLeft|itemTop|stopPropagation|_set_navigation|100|prop|auto|setExpression|parentNode|right|_preload_neighbor_images|animateLoading|appendTo|fancy_inner|no|frameborder|tr|fancy_right_ico|fast|fancy_left_ico|javascript|fixPNG|defaults|easingOut|easingChange|overlayOpacity|build|easingIn|zoomSpeedChange|padding|backgroundImage|imageScale|stop|table|clearInterval|showLoading|fancy_frame|||showIframe||complete|load|bmp|jpeg|fancy_div|split|replace|enabled|scrollLeft|className|paddingTop|random|1000|fancy_iframe|name|scrollTop|onload|location|hidden|RegExp|jquery|355|url|extend|ready|version|jpg|425|for|borderLeftWidth|hspace|while|300|paddingLeft|curCSS|borderTopWidth|msie|fancy_ajax|fancy_bg_w|scale|fancy_bg_sw|fancy_bg_nw|setInterval|DXImageTransform|clientWidth|sizingMethod|fancy_bg_s|fancy_bg_se|progid|66|gif|repeat||backgroundRepeat|fancy_bg_e|fancy_bg_ne|fancy_bg_n|none|body|prepend|alt|fancy_img|fancy_bigIframe|60|crop|AlphaImageLoader|scrolling|jQuery|offset|cellpadding|cellspacing|clientHeight|border|fancy_title_left|Microsoft|fancy_title_right|fancy_title_main|get'.split('|'),0,{}))